<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å‘½è¿é»‘ç›’ Pro Max Â· å®—å¸ˆå…¨æœ¬ç»ˆæç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.min.js"></script>
    <style>
        :root {
            --primary: #ff0055; --accent: #00fff2; --dark: #0a0a0c; --card: #161b22;
            --text: #e6edf3; --gold: #f1c40f; --border-r: 12px;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
            background-color: var(--dark); color: var(--text);
            margin: 0; padding: 20px 10px; min-height: 100vh;
            background-image: radial-gradient(circle at 50% 50%, #1c1c2b 0%, #0a0a0c 100%);
            display: flex; justify-content: center;
        }
        .container { width: 100%; max-width: 750px; padding-bottom: 120px; }
        .header { text-align: center; margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px; }
        .header h1 { 
            font-size: 2.2rem; font-weight: 900; margin: 0; letter-spacing: 4px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 0, 85, 0.3);
        }
        .sys-badge { 
            font-size: 0.75rem; border: 1px solid var(--accent); color: var(--accent);
            padding: 4px 14px; border-radius: 20px; display: inline-block; margin-top: 10px;
            text-transform: uppercase; letter-spacing: 2px; font-weight: bold;
        }
        .card {
            background: var(--card); border: 1px solid rgba(255,255,255,0.06);
            border-radius: var(--border-r); padding: 25px; margin-bottom: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.6); position: relative; overflow: hidden;
        }
        .card::after {
            content: ''; position: absolute; top: 0; left: 0; width: 3px; height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--accent));
        }
        .input-group { margin-bottom: 20px; }
        .label { color: var(--gold); font-size: 0.85rem; margin-bottom: 8px; display: block; font-weight: bold; }
        .gender-box { display: flex; gap: 15px; }
        .g-btn {
            flex: 1; padding: 16px; text-align: center; border-radius: 10px; background: rgba(255,255,255,0.02);
            border: 1px solid #333; color: #888; cursor: pointer; transition: 0.3s; font-weight: bold;
        }
        .g-btn.active { border-color: var(--primary); color: #fff; background: rgba(255, 0, 85, 0.15); }
        input[type="datetime-local"] {
            width: 100%; padding: 16px; background: rgba(0,0,0,0.3); border: 1px solid #333;
            color: #fff; border-radius: 10px; font-size: 1.1rem; outline: none;
        }
        .btn-start {
            width: 100%; padding: 18px; border: none; border-radius: 10px;
            background: linear-gradient(135deg, var(--primary), #6f00ff);
            color: #fff; font-size: 1.2rem; font-weight: 900; letter-spacing: 3px;
            cursor: pointer; margin-top: 15px; box-shadow: 0 15px 40px rgba(255, 0, 85, 0.3);
        }
        #result-area { display: none; }
        .role-header { display: flex; align-items: flex-start; padding-bottom: 20px; border-bottom: 1px dashed rgba(255,255,255,0.1); margin-bottom: 25px; }
        .role-icon {
            width: 80px; height: 80px; background: #000; border-radius: 20px;
            display: flex; align-items: center; justify-content: center; font-size: 42px;
            border: 2px solid var(--gold); margin-right: 20px; flex-shrink: 0;
            box-shadow: 0 0 25px rgba(241, 196, 15, 0.2);
        }
        .role-title { font-size: 1.8rem; font-weight: bold; color: #fff; margin: 0 0 8px 0; }
        .role-sub { font-size: 0.95rem; color: #999; font-style: italic; line-height: 1.4; }
        .role-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; }
        .tag { font-size: 0.75rem; padding: 5px 12px; border-radius: 6px; background: rgba(255,255,255,0.05); color: #bbb; }
        .tag.ssr { background: linear-gradient(45deg, var(--primary), var(--gold)); color: #000; font-weight: bold; }
        .tag.logic { border: 1px solid var(--accent); color: var(--accent); }
        .siling-bar {
            background: linear-gradient(90deg, rgba(241, 196, 15, 0.1), transparent);
            border-left: 4px solid var(--gold); padding: 12px 15px; margin-bottom: 25px; border-radius: 4px;
            color: var(--gold); font-weight: bold; font-size: 0.95rem; display: flex; align-items: center; gap: 12px;
        }
        .chart-box { height: 200px; width: 100%; border-radius: 12px; overflow: hidden; margin-bottom: 25px; background: rgba(0,0,0,0.4); border: 1px solid #333; }
        canvas { width: 100%; height: 100%; }
        .pillars { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 25px; }
        .col { background: rgba(255,255,255,0.02); border-radius: 10px; padding: 15px 5px; text-align: center; border: 1px solid #222; }
        .c-head { font-size: 0.7rem; color: #666; margin-bottom: 6px; }
        .c-god { font-size: 0.75rem; color: var(--accent); height: 16px; margin-bottom: 5px; font-weight: bold; }
        .c-char { font-family: "KaiTi", serif; font-size: 2rem; font-weight: bold; color: #fff; margin-bottom: 6px; line-height: 1; }
        .c-cs { font-size: 0.7rem; color: #888; display: block; }
        .logic-bar { margin-top: 25px; padding: 20px; background: rgba(0,0,0,0.3); border: 1px solid #333; font-size: 0.95rem; line-height: 1.8; border-radius: 10px; }
        .logic-title { color: var(--accent); font-weight: bold; display: block; margin-bottom: 12px; font-size: 1rem; }
        .good-text { color: #2ecc71; font-weight: bold; margin-right: 8px; } 
        .bad-text { color: #ff4757; font-weight: bold; margin-right: 8px; }
        .guide-item { margin-bottom: 30px; padding: 25px; border-radius: 12px; background: rgba(255,255,255,0.02); border-left: 4px solid var(--primary); }
        .guide-title { font-size: 1.1rem; font-weight: bold; color: var(--gold); margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .guide-text { font-size: 1rem; line-height: 2; color: #ccc; text-align: justify; }
        .guide-text b { color: #fff; border-bottom: 1px dotted rgba(255,255,255,0.3); padding-bottom: 2px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>å‘½è¿é»‘ç›’</h1>
        <div class="sys-badge">SYSTEM: GRANDMASTER COMPLETE V25.0</div>
    </div>

    <div class="card">
        <div class="input-group">
            <span class="label">é€‰æ‹©è§’è‰²æ€§åˆ«</span>
            <div class="gender-box">
                <div class="g-btn active" onclick="setGender(1, this)">ä¹¾é€  (Male)</div>
                <div class="g-btn" onclick="setGender(0, this)">å¤é€  (Female)</div>
            </div>
        </div>
        <div class="input-group">
            <span class="label">è¾“å…¥å‡ºç”Ÿæ—¶é—´</span>
            <input type="datetime-local" id="birth-input">
        </div>
        <button class="btn-start" onclick="startScan()">å¯åŠ¨å®—å¸ˆçº§æ¨æ¼”</button>
    </div>

    <div id="result-area">
        <div class="card">
            <div class="role-header">
                <div class="role-icon" id="role-icon">?</div>
                <div class="role-info">
                    <h2 class="role-title" id="role-name">åˆ†æä¸­...</h2>
                    <div class="role-sub" id="role-slogan">...</div>
                    <div class="role-tags" id="role-tags"></div>
                </div>
            </div>
            <div class="siling-bar" id="siling-box">
                <span style="font-size:1.4rem">ğŸ‘‘</span> 
                <span id="siling-text">æ­£åœ¨è®¡ç®—çœŸç¥...</span>
            </div>
            <div class="chart-box"><canvas id="energy-canvas"></canvas></div>
            <div class="pillars" id="pillars-box"></div>
            <div class="logic-bar">
                <span class="logic-title">âš¡ æ ¼å±€å–œå¿Œé“å¾‹ (Core Logic)</span>
                <div id="pattern-reason" style="margin-bottom:12px; color:#aaa;"></div>
                <div><span class="good-text">â˜… å–œç”¨ï¼š</span> <span id="txt-joy" style="color:#eee">...</span></div>
                <div style="margin-top:8px;"><span class="bad-text">âœ– å¿Œç¥ï¼š</span> <span id="txt-taboo" style="color:#eee">...</span></div>
            </div>
        </div>
        <div class="card">
            <span class="label" style="margin-bottom:20px; font-size:1.1rem; color:var(--accent);">å¤©å‘½é€šå…³æ”»ç•¥ / STRATEGY GUIDE</span>
            <div id="guide-content"></div>
        </div>
    </div>
</div>

<script>
    let currentGender = 1;
    const WUXING_MAP = {'ç”²':'æœ¨','ä¹™':'æœ¨','ä¸™':'ç«','ä¸':'ç«','æˆŠ':'åœŸ','å·±':'åœŸ','åºš':'é‡‘','è¾›':'é‡‘','å£¬':'æ°´','ç™¸':'æ°´','å­':'æ°´','ä¸‘':'åœŸ','å¯…':'æœ¨','å¯':'æœ¨','è¾°':'åœŸ','å·³':'ç«','åˆ':'ç«','æœª':'åœŸ','ç”³':'é‡‘','é…‰':'é‡‘','æˆŒ':'åœŸ','äº¥':'æ°´'};
    const WX_COLOR = { 'é‡‘':'wx-é‡‘', 'æœ¨':'wx-æœ¨', 'æ°´':'wx-æ°´', 'ç«':'wx-ç«', 'åœŸ':'wx-åœŸ' };
    const ZHI_MAIN_QI = {'å­':'ç™¸', 'ä¸‘':'å·±', 'å¯…':'ç”²', 'å¯':'ä¹™', 'è¾°':'æˆŠ', 'å·³':'ä¸™', 'åˆ':'ä¸', 'æœª':'å·±', 'ç”³':'åºš', 'é…‰':'è¾›', 'æˆŒ':'æˆŠ', 'äº¥':'å£¬'};
    const SILING_RULES = {
        'å¯…': [['æˆŠ',7], ['ä¸™',7], ['ç”²',16]], 'å¯': [['ç”²',10], ['ä¹™',20]], 'è¾°': [['ä¹™',9], ['ç™¸',3], ['æˆŠ',18]],
        'å·³': [['æˆŠ',5], ['åºš',9], ['ä¸™',16]], 'åˆ': [['ä¸™',10], ['å·±',9], ['ä¸',11]], 'æœª': [['ä¸',9], ['ä¹™',3], ['å·±',18]],
        'ç”³': [['æˆŠ',7], ['å£¬',7], ['åºš',16]], 'é…‰': [['åºš',10], ['è¾›',20]], 'æˆŒ': [['è¾›',9], ['ä¸',3], ['æˆŠ',18]],
        'äº¥': [['æˆŠ',7], ['ç”²',5], ['å£¬',18]], 'å­': [['å£¬',10], ['ç™¸',20]], 'ä¸‘': [['ç™¸',9], ['è¾›',3], ['å·±',18]]
    };
    const ROOT_MAP = {'ç”²':['å¯…','å¯','äº¥','è¾°','æœª'],'ä¹™':['å¯','å¯…','è¾°','æœª','äº¥'],'ä¸™':['å·³','åˆ','å¯…','æˆŒ'],'ä¸':['åˆ','å·³','æœª','æˆŒ','å¯…'],'æˆŠ':['è¾°','æˆŒ','ä¸‘','æœª','å·³','åˆ'],'å·±':['ä¸‘','æœª','è¾°','æˆŒ','åˆ','å·³'],'åºš':['ç”³','é…‰','å·³','ä¸‘','æˆŒ'],'è¾›':['é…‰','ç”³','ä¸‘','æˆŒ','å·³'],'å£¬':['äº¥','å­','ç”³','è¾°'],'ç™¸':['å­','äº¥','è¾°','ä¸‘','ç”³']};
    const CHANGSHENG_TABLE = {"ç”²":{"äº¥":"é•¿ç”Ÿ","å­":"æ²æµ´","ä¸‘":"å† å¸¦","å¯…":"ä¸´å®˜","å¯":"å¸æ—º","è¾°":"è¡°","å·³":"ç—…","åˆ":"æ­»","æœª":"å¢“","ç”³":"ç»","é…‰":"èƒ","æˆŒ":"å…»"},"ä¹™":{"åˆ":"é•¿ç”Ÿ","å·³":"æ²æµ´","è¾°":"å† å¸¦","å¯":"ä¸´å®˜","å¯…":"å¸æ—º","ä¸‘":"è¡°","å­":"ç—…","äº¥":"æ­»","æˆŒ":"å¢“","é…‰":"ç»","ç”³":"èƒ","æœª":"å…»"},"ä¸™":{"å¯…":"é•¿ç”Ÿ","å¯":"æ²æµ´","è¾°":"å† å¸¦","å·³":"ä¸´å®˜","åˆ":"å¸æ—º","æœª":"è¡°","ç”³":"ç—…","é…‰":"æ­»","æˆŒ":"å¢“","äº¥":"ç»","å­":"èƒ","ä¸‘":"å…»"},"ä¸":{"é…‰":"é•¿ç”Ÿ","ç”³":"æ²æµ´","æœª":"å† å¸¦","åˆ":"ä¸´å®˜","å·³":"å¸æ—º","è¾°":"è¡°","å¯":"ç—…","å¯…":"æ­»","ä¸‘":"å¢“","å­":"ç»","äº¥":"èƒ","æˆŒ":"å…»"},"æˆŠ":{"å¯…":"é•¿ç”Ÿ","å¯":"æ²æµ´","è¾°":"å† å¸¦","å·³":"ä¸´å®˜","åˆ":"å¸æ—º","æœª":"è¡°","ç”³":"ç—…","é…‰":"æ­»","æˆŒ":"å¢“","äº¥":"ç»","å­":"èƒ","ä¸‘":"å…»"},"å·±":{"é…‰":"é•¿ç”Ÿ","ç”³":"æ²æµ´","æœª":"å† å¸¦","åˆ":"ä¸´å®˜","å·³":"å¸æ—º","è¾°":"è¡°","å¯":"ç—…","å¯…":"æ­»","ä¸‘":"å¢“","å­":"ç»","äº¥":"èƒ","æˆŒ":"å…»"},"åºš":{"å·³":"é•¿ç”Ÿ","åˆ":"æ²æµ´","æœª":"å† å¸¦","ç”³":"ä¸´å®˜","é…‰":"å¸æ—º","æˆŒ":"è¡°","äº¥":"ç—…","å­":"æ­»","ä¸‘":"å¢“","å¯…":"ç»","å¯":"èƒ","è¾°":"å…»"},"è¾›":{"å­":"é•¿ç”Ÿ","äº¥":"æ²æµ´","æˆŒ":"å† å¸¦","é…‰":"ä¸´å®˜","ç”³":"å¸æ—º","æœª":"è¡°","åˆ":"ç—…","å·³":"æ­»","è¾°":"å¢“","å¯":"ç»","å¯…":"èƒ","ä¸‘":"å…»"},"å£¬":{"ç”³":"é•¿ç”Ÿ","é…‰":"æ²æµ´","æˆŒ":"å† å¸¦","äº¥":"ä¸´å®˜","å­":"å¸æ—º","ä¸‘":"è¡°","å¯…":"ç—…","å¯":"æ­»","è¾°":"å¢“","å·³":"ç»","åˆ":"èƒ","æœª":"å…»"},"ç™¸":{"å¯":"é•¿ç”Ÿ","å¯…":"æ²æµ´","ä¸‘":"å† å¸¦","å­":"ä¸´å®˜","äº¥":"å¸æ—º","æˆŒ":"è¡°","é…‰":"ç—…","ç”³":"æ­»","æœª":"å¢“","åˆ":"ç»","å·³":"èƒ","è¾°":"å…»"}};
    const SHISHEN_MAP = {"ç”²":{"ç”²":"æ¯”è‚©","ä¹™":"åŠ«è´¢","ä¸™":"é£Ÿç¥","ä¸":"ä¼¤å®˜","æˆŠ":"åè´¢","å·±":"æ­£è´¢","åºš":"ä¸ƒæ€","è¾›":"æ­£å®˜","å£¬":"åå°","ç™¸":"æ­£å°"},"ä¹™":{"ä¹™":"æ¯”è‚©","ç”²":"åŠ«è´¢","ä¸":"é£Ÿç¥","ä¸™":"ä¼¤å®˜","å·±":"åè´¢","æˆŠ":"æ­£è´¢","è¾›":"ä¸ƒæ€","åºš":"æ­£å®˜","ç™¸":"åå°","å£¬":"æ­£å°"},"ä¸™":{"ä¸™":"æ¯”è‚©","ä¸":"åŠ«è´¢","æˆŠ":"é£Ÿç¥","å·±":"ä¼¤å®˜","åºš":"åè´¢","è¾›":"æ­£è´¢","å£¬":"ä¸ƒæ€","ç™¸":"æ­£å®˜","ç”²":"åå°","ä¹™":"æ­£å°"},"ä¸":{"ä¸":"æ¯”è‚©","ä¸™":"åŠ«è´¢","å·±":"é£Ÿç¥","æˆŠ":"ä¼¤å®˜","è¾›":"åè´¢","åºš":"æ­£è´¢","ç™¸":"ä¸ƒæ€","å£¬":"æ­£å®˜","ä¹™":"åå°","ç”²":"æ­£å°"},"æˆŠ":{"æˆŠ":"æ¯”è‚©","å·±":"åŠ«è´¢","åºš":"é£Ÿç¥","è¾›":"ä¼¤å®˜","å£¬":"åè´¢","ç™¸":"æ­£è´¢","ç”²":"ä¸ƒæ€","ä¹™":"æ­£å®˜","ä¸™":"åå°","ä¸":"æ­£å°"},"å·±":{"å·±":"æ¯”è‚©","æˆŠ":"åŠ«è´¢","è¾›":"é£Ÿç¥","åºš":"ä¼¤å®˜","ç™¸":"åè´¢","å£¬":"æ­£è´¢","ä¹™":"ä¸ƒæ€","ç”²":"æ­£å®˜","ä¸":"åå°","ä¸™":"æ­£å°"},"åºš":{"åºš":"æ¯”è‚©","è¾›":"åŠ«è´¢","å£¬":"é£Ÿç¥","ç™¸":"ä¼¤å®˜","ç”²":"åè´¢","ä¹™":"æ­£è´¢","ä¸™":"ä¸ƒæ€","ä¸":"æ­£å®˜","æˆŠ":"åå°","å·±":"æ­£å°"},"è¾›":{"è¾›":"æ¯”è‚©","åºš":"åŠ«è´¢","ç™¸":"é£Ÿç¥","å£¬":"ä¼¤å®˜","ä¹™":"åè´¢","ç”²":"æ­£è´¢","ä¸":"ä¸ƒæ€","ä¸™":"æ­£å®˜","å·±":"åå°","æˆŠ":"æ­£å°"},"å£¬":{"å£¬":"æ¯”è‚©","ç™¸":"åŠ«è´¢","ç”²":"é£Ÿç¥","ä¹™":"ä¼¤å®˜","ä¸™":"åè´¢","ä¸":"æ­£è´¢","æˆŠ":"ä¸ƒæ€","å·±":"æ­£å®˜","åºš":"åå°","è¾›":"æ­£å°"},"ç™¸":{"ç™¸":"æ¯”è‚©","å£¬":"åŠ«è´¢","ä¹™":"é£Ÿç¥","ç”²":"ä¼¤å®˜","ä¸":"åè´¢","ä¸™":"æ­£è´¢","å·±":"ä¸ƒæ€","æˆŠ":"æ­£å®˜","è¾›":"åå°","åºš":"æ­£å°"}};

    const GAME_DB = {
        "é‡‘æ°´ä¼¤å®˜": { name: "â„ï¸ å¯’å†°å‰‘ä»™", tags: ["SSR","æƒè°‹"], icon: "ğŸ—¡ï¸", slogan: "é‡‘å¯’æ°´å†·ï¼Œå”¯ç«æš–å¿ƒã€‚", male: { c:"[å¤©èµ‹] æåº¦èªé¢–ï¼Œæ€ç»´å¦‚å†°åˆ€åˆ‡å¼€å¤æ‚æ ¸å¿ƒã€‚é€‚åˆæ”¿æ²»é«˜å±‚ã€æˆ˜ç•¥æ™ºå›Šã€‚å±€ä¸­è§ç«å³ä¸ºæ˜¾è´µï¼Œæ— ç«åˆ™å­¤å‚²æ¸…è´«ã€‚", w:"[è´¢å¯Œ] éšæƒè€Œå¯Œï¼Œè´¢è¿é€šå¸¸ä¼´éšç¤¾ä¼šåœ°ä½ã€‚æ°´æ¸…åˆ™æ— é±¼ï¼Œåˆ‡å¿Œç°è´¢ã€‚", l:"[ç¾ç»Š] éœ€æ‰¾'å°å¤ªé˜³'å‹ä¼´ä¾£ã€‚å¯¹æ–¹çš„çƒ­æƒ…èƒ½èåŒ–ä½ çš„å†°å†·ã€‚", k:"[ä¼ æ‰¿] ä¸¥çˆ¶å‡ºå­å­ï¼Œå¯¹å­©å­è¦æ±‚æé«˜ï¼Œå­©å­å¤šä¸ºç²¾è‹±ã€‚", h:"[é”¦å›Š] å¿…ç”¨ç«è°ƒå€™ã€‚å¤šæ™’å¤ªé˜³ï¼Œå±…ä½åœ°å®œå—æ–¹ã€‚" }, female: { c:"[å¤©èµ‹] å†°å±±ç¾äººï¼Œæ°”è´¨è¶…ç¾¤ï¼Œé€‚åˆæ¼”è‰ºæˆ–å¤–äº¤ã€‚æ‰åéœ€è¢«èšå…‰ç¯çœ‹è§ã€‚", w:"[è´¢å¯Œ] å¤«è£å¦»è´µã€‚å®˜æ˜Ÿï¼ˆç«ï¼‰ä¸ä»…æ˜¯å¤«ï¼Œä¹Ÿæ˜¯ä½ çš„æ•‘æ˜Ÿï¼Œæˆå°±ä¸ˆå¤«å³æˆå°±è‡ªå·±ã€‚", l:"[ç¾ç»Š] ç‹¬å–œå®˜æ˜Ÿå‘µæŠ¤ã€‚å¤–è¡¨é«˜å†·æŒ‘å‰”ï¼Œå†…å¿ƒæå…¶æ¸´æœ›è¢«å‘µæŠ¤ã€‚", k:"[ä¼ æ‰¿] è´µå­ä¸´é—¨ã€‚ç”Ÿå­©å­èƒ½æ˜¾è‘—æå‡è¿åŠ¿ã€‚", h:"[é”¦å›Š] æš–å®«é©±å¯’ã€‚å°‘åƒç”Ÿå†·ï¼Œä¿æŒä½“æ¸©å³æ˜¯ä¿è¿ã€‚" } },
        "é‡‘æ°´é£Ÿç¥": { name: "ğŸŒŠ çµåŠ¨æ™ºè€…", tags: ["SSR","æ¸…è´µ"], icon: "ğŸŒŠ", slogan: "é‡‘ç™½æ°´æ¸…ï¼Œæ‰æ€æ³‰æ¶Œã€‚", male: { c:"[å¤©èµ‹] æ‰åæ¨ªæº¢ä½†å†…æ•›æ·±æ²‰ã€‚é€‚åˆå­¦æœ¯æ·±è€•æˆ–è‰ºæœ¯åˆ›ä½œã€‚æ€§æ ¼æ¸©æ¶¦å¦‚ç‰ï¼Œè§ç«åˆ™ååˆ©åŒæ”¶ã€‚", w:"[è´¢å¯Œ] æŠ€è‰ºç”Ÿè´¢ã€‚é ä¸å¯æ›¿ä»£çš„ä¸“ä¸šå£å’è‡´å¯Œï¼Œä¸€ç”Ÿä¸ç¼ºé’±è´¢ã€‚", l:"[ç¾ç»Š] å¯»æ‰¾çµé­‚çŸ¥å·±ã€‚è¿½æ±‚ç²¾ç¥é«˜åº¦å¥‘åˆï¼Œèƒ½å¬æ‡‚ä½ çš„å¼¦å¤–ä¹‹éŸ³ã€‚", k:"[ä¼ æ‰¿] èªæ…§éº’éºŸã€‚æ•™è‚²å¼€æ˜ï¼Œçˆ¶å­å¦‚å‹ã€‚", h:"[é”¦å›Š] è¡¥ç«è¡¥é˜³ã€‚å¤šåšæˆ·å¤–è¿åŠ¨ï¼Œä¿æŒå¼€æœ—å¿ƒæ€ã€‚" }, female: { c:"[å¤©èµ‹] æ¸…æ–°è„±ä¿—ï¼Œæ°”è´¨å¦‚ç™½æœˆå…‰ã€‚åœ¨æ–‡åŒ–ã€æ•™è‚²è¡Œä¸šèƒ½è‡ªæˆä¸€å®¶ã€‚", w:"[è´¢å¯Œ] å°ç¡®å¹¸ä¸æ–­ï¼Œä¸€ç”Ÿè¡£é£Ÿæ— å¿§ã€‚æ€»æœ‰è´µäººæˆ–é•¿è¾ˆä¸ºä½ é“ºè·¯ã€‚", l:"[ç¾ç»Š] å¯’è°·å›æ˜¥ã€‚æ¸©æŸ”æ˜¯ç»ˆææ€å™¨ï¼Œèƒ½å¾—åˆ°ä¼´ä¾£é•¿ä¹…çš„å® çˆ±ã€‚", k:"[ä¼ æ‰¿] å­å¥³ç¼˜æ·±ã€‚å­©å­æ€§æ ¼æ¸©å’Œï¼Œæ™šå¹´ç¦æ°”æ»¡æ»¡ã€‚", h:"[é”¦å›Š] æ»‹é˜´è¡¥é˜³ã€‚ä¿æŒå¿ƒæƒ…æ„‰å¿«ï¼Œå¿ƒæƒ…å¥½èº«ä½“å°±å¥½ã€‚" } },
        "ä¼¤å®˜é…å°": { name: "ğŸ”® æ™ºè€…ç¥å¯", tags: ["UR","æ™ºæ…§"], icon: "ğŸ“œ", slogan: "çƒˆç«çƒ¹æ²¹ï¼Œæ·±æ°´é™æµã€‚", male: { c:"[å¤©èµ‹] é™ç»´æ‰“å‡»çš„æ€ç»´èƒ½åŠ›ã€‚é€‚åˆå¹•åè¿ç­¹å¸·å¹„ï¼Œå¦‚é¡¶çº§å‚è°‹æˆ–æˆ˜ç•¥å®¶ã€‚æ ¸å¿ƒåœ¨äºæ™ºæ…§ä¸å†·é™çš„å®Œç¾ç»“åˆã€‚", w:"[è´¢å¯Œ] çŸ¥è¯†äº§æƒè‡´å¯Œã€‚å¿Œè´ªè´¢åå°ï¼Œè´¢è¿æ¥è‡ªåæœ›ã€ä¸“åˆ©å’Œé¡¾é—®è´¹ã€‚", l:"[ç¾ç»Š] è´µäººä¼´ä¾£ã€‚ä¼´ä¾£èƒ½è®©ä½ åœ¨ç„¦èºæ—¶å†·é™ä¸‹æ¥ï¼Œæ˜¯å‘½ä¸­çš„å®šæµ·ç¥é’ˆã€‚", k:"[ä¼ æ‰¿] ä¹¦é¦™é—¨ç¬¬ã€‚å­©å­èªæ˜å¥½å­¦ï¼Œæœ‰æ·±åšçš„æ–‡åŒ–åº•è•´ã€‚", h:"[é”¦å›Š] æ°´ç«æ—¢æµã€‚é˜²å¿ƒç«è¿‡æ—ºï¼Œä¿æŒæ·¡å®šå¿ƒæ€ã€‚" }, female: { c:"[å¤©èµ‹] è´µæ°”æ‰å¥³ã€‚ä»¥æŸ”å…‹åˆšï¼ŒèŒåœºä¸­å¤‡å—å™¨é‡ã€‚ä½ çš„é€»è¾‘å’Œä¿®å…»è®©ç«äº‰å¯¹æ‰‹æŠ˜æœã€‚", w:"[è´¢å¯Œ] å…»è´¢ã€‚é€‚åˆé•¿çº¿æŠ•èµ„ï¼Œè¿œç¦»æŠ•æœºï¼Œç¨³å¥ä¸­è§è´¢å¯Œã€‚", l:"[ç¾ç»Š] æ‰¾ä¸ªåŒ…å®¹ä½ çš„æš–ç”·ï¼Œå¹¸ç¦æ„Ÿæœ€é«˜ï¼Œä¸å¿…å¼ºæ±‚å¯¹æ–¹å¤šå¯Œè´µã€‚", k:"[ä¼ æ‰¿] çµæ€§ç§å­ã€‚å­©å­æœ‰è‰ºæœ¯å¤©èµ‹æˆ–ç„å­¦ç¼˜åˆ†ã€‚", h:"[é”¦å›Š] æ»‹é˜´å…»é¢œã€‚å¤šè¡¥æ°´ï¼Œå°‘ç†¬å¤œï¼Œä¿æŒçµç§€ä¹‹æ°”ã€‚" } },
        "ä¼¤å®˜åˆæ€": { name: "âš¡ å±æœºç»ˆç»“è€…", tags: ["SSR","çˆ†å‘"], icon: "ğŸ—¡ï¸", slogan: "æ··ä¹±æ˜¯é˜¶æ¢¯ï¼Œæƒè°‹æ˜¯åˆ©åˆƒã€‚", male: { c:"[å¤©èµ‹] ä¹±ä¸–æ­é›„ã€‚å±æœºå…¬å…³ã€é»‘ç™½é€šåƒçš„å¤©æ‰ã€‚è¶Šä¹±è¶Šèƒ½æ¿€å‘Sçº§æ½œèƒ½ã€‚æ“…é•¿åœ¨å¤æ‚å±€åŠ¿ä¸­æ‰¾åˆ°æ·å¾„ã€‚", w:"[è´¢å¯Œ] æ å¤ºå¼è´¢å¯Œã€‚åˆ©ç”¨ä¿¡æ¯å·®å’Œèƒ†è¯†é™ç»´ç‹©çŒã€‚å¤§è¿›å¤§å‡ºï¼Œæ³¢åŠ¨å‰§çƒˆã€‚", l:"[ç¾ç»Š] ç›¸çˆ±ç›¸æ€ã€‚å©šå§»æ˜¯ä¸€åœºé«˜æ™ºå•†åšå¼ˆï¼Œå……æ»¡æ¿€æƒ…ä¸æŒ‘æˆ˜ã€‚", k:"[ä¼ æ‰¿] å›é€†å¤©æ‰ã€‚åˆ«é€¼å­©å­å¬è¯ï¼Œä»–æ˜¯è¦æ”¹å˜è§„åˆ™çš„å‹‡è€…ã€‚", h:"[é”¦å›Š] é˜²è¿‡è½½ã€‚ç¥ç»ç³»ç»Ÿæ˜“ç´§ç»·ï¼Œå­¦ä¼šå¼ºåˆ¶ä¼‘å‡å…³æœºã€‚" }, female: { c:"[å¤©èµ‹] é“å¨˜å­æ°”åœºã€‚èŒåœºé•‡å±±çŸ³ï¼Œèƒ½æå®šæœ€éš¾ç¼ çš„å¯¹æ‰‹ã€‚å¨ä¿¡æé«˜ã€‚", w:"[è´¢å¯Œ] åæ°”å˜ç°ã€‚åœˆå±‚ç½®æ¢ï¼Œé€‚åˆç½®åŠä¸åŠ¨äº§ä½œä¸ºé˜²çº¿ã€‚", l:"[ç¾ç»Š] æ…•å¼ºå¿ƒç†ã€‚æ¬£èµç¡¬æ±‰ï¼Œä½ æ˜¯å®¶é‡Œçš„å®šæµ·ç¥é’ˆå’Œä¸»æ§æ ¸å¿ƒã€‚", k:"[ä¼ æ‰¿] ç²¾è‹±æ•™è‚²ã€‚å­©å­å‡ºç±»æ‹”èƒï¼Œä½†è¦æ³¨æ„ä¸è¦äº§ç”Ÿä»£æ²Ÿã€‚", h:"[é”¦å›Š] æƒ…ç»ªå†…è€—ã€‚å¤šåšç‘œä¼½æˆ–å†¥æƒ³ï¼Œè°ƒç†å†…åˆ†æ³Œã€‚" } },
        "æ­£è´¢æ ¼": { name: "ğŸœ å‹¤å‹‰ç­‘æ¢¦å¸ˆ", tags: ["R+","ç¨³å¥"], icon: "ğŸ§±", slogan: "ä¸€ç –ä¸€ç“¦ï¼Œèšæ²™æˆå¡”ã€‚", male: { c:"[å¤©èµ‹] ç›¸ä¿¡åŠªåŠ›å³å›æŠ¥ã€‚è¸å®ã€ç»†èŠ‚æ§ã€‚åœ¨é‡‘èã€å®ä¸šç­‰ä¼ ç»Ÿé¢†åŸŸèƒ½æˆä¸ºä¸­åšåŠ›é‡ã€‚", w:"[è´¢å¯Œ] å¤åˆ©è‡´å¯Œã€‚å…¸å‹çš„ç§¯ç´¯è‡´å¯Œï¼Œä¸è´ªæš´å¯Œï¼Œé æ—¶é—´æ»šé›ªçƒã€‚", l:"[ç¾ç»Š] å® å¦»ç‹‚é­”ã€‚å·¥èµ„å¡ä¸Šäº¤ï¼Œè®¤ä¸ºå¬è€å©†è¯èƒ½å‘å¤§è´¢ã€‚", k:"[ä¼ æ‰¿] æœ´å®å®¶é£ã€‚æ•™å¯¼èŠ‚çº¦ï¼Œå­©å­æ€§æ ¼æ­£ç›´ï¼Œè¸å®è‚¯å¹²ã€‚", h:"[é”¦å›Š] æ³¨æ„åŠ³æŸã€‚é•¿æœŸå¤„äºå·¥ä½œæ¨¡å¼ï¼Œä¿æŠ¤å¥½è…°æ¤å’Œè‚ èƒƒã€‚" }, female: { c:"[å¤©èµ‹] ç²¾ç»†åŒ–ç®¡å®¶ã€‚è€å¿ƒè‡´å¯†ï¼Œé€»è¾‘ä¸¥æ•´ã€‚é€‚åˆä¼šè®¡ã€HRã€æ•°æ®ç®¡ç†ã€‚", w:"[è´¢å¯Œ] å­˜é’±ç½å±æ€§ã€‚ç†è´¢æç¨³ï¼Œå®¶åº­èµ„äº§æ‰“ç†å¾—äº•äº•æœ‰æ¡ã€‚", l:"[ç¾ç»Š] è´¤æƒ æŒå®¶ã€‚æ˜¯ä¼´ä¾£çš„ä¾é ã€‚å¶å°”éœ€è¦æå‡ç”Ÿæ´»æµªæ¼«åº¦ã€‚", k:"[ä¼ æ‰¿] åŒ…åŠæ¯çˆ±ã€‚å­¦ä¼šé€‚åº¦æ”¾æ‰‹ï¼Œè®©å­©å­è‡ªå·±é¢å¯¹é£é›¨ã€‚", h:"[é”¦å›Š] æ°”è¡€è™šå¼±ã€‚å¤šåƒæ¸©è¡¥é£Ÿç‰©ï¼Œå°‘å®…åœ¨å®¶ï¼Œå¤šèµ°åŠ¨ã€‚" } },
        "ä¸ƒæ€æ ¼": { name: "ğŸš€ å­¤èƒ†è‹±é›„", tags: ["SSR","å¼€åˆ›"], icon: "ğŸ”¥", slogan: "äººç”Ÿå°±æ˜¯ä¸€åœºæ— é™çš„æˆ˜æ–—ã€‚", male: { c:"[å¤©èµ‹] æ”»åšèƒ½åŠ›çˆ†è¡¨ã€‚åˆ›ä¸šå¼€è’é¦–é€‰ã€‚æ‰§è¡ŒåŠ›æå¼ºï¼Œæ˜¯å¤©ç”Ÿçš„ç»Ÿå¸…ã€‚", w:"[è´¢å¯Œ] é™©ä¸­å–ã€‚è´¢è¿æ³¢åŠ¨å‰§çƒˆï¼Œå¿…é¡»å¼ºåˆ¶ç½®åŠå›ºå®šèµ„äº§ç•™è·¯ã€‚", l:"[ç¾ç»Š] çƒˆç«æƒ…äººã€‚æ„Ÿæƒ…æ¿€çƒˆï¼ŒåºŠå¤´åµæ¶åºŠå°¾å’Œï¼Œè¿½æ±‚æ¿€æƒ…ã€‚", k:"[ä¼ æ‰¿] ä¸¥å¸ˆã€‚æ£æ£’åº•ä¸‹å‡ºå­å­ï¼Œè¦æ³¨æ„å±•ç°æŸ”æƒ…çš„ä¸€é¢ã€‚", h:"[é”¦å›Š] æ„å¤–é£é™©ã€‚å¼€è½¦æ…¢ç‚¹ï¼Œå¤šåšæ…ˆå–„åŒ–è§£ç…æ°”ã€‚" }, female: { c:"[å¤©èµ‹] å·¾å¸¼ä¸è®©é¡»çœ‰ã€‚ä¸šåŠ¡ä¸€å§ï¼Œç”·äººå †é‡ŒæŠ¢é¥­åƒï¼Œæ‰§è¡ŒåŠ›æå¼ºã€‚", w:"[è´¢å¯Œ] èµšé’±æœºå™¨ã€‚å¤§è¿›å¤§å‡ºï¼Œéœ€ä¸“ä¸šç†è´¢ã€‚ä½ æ›´äº«å—èµšé’±çš„è¿‡ç¨‹ã€‚", l:"[ç¾ç»Š] éœ¸æ€»æ”¶å‰²æœºã€‚å–œæ¬¢è¢«å¾æœæ„Ÿï¼Œä½†ä¹Ÿå®¹æ˜“é‡åˆ°ç¡¬ç¢°ç¡¬çš„äº‰åµã€‚", k:"[ä¼ æ‰¿] è¶…äººå¦ˆå¦ˆã€‚ä¸ºå­©å­æ’‘èµ·ä¸€ç‰‡å¤©ï¼Œæ˜¯å­©å­çš„ç²¾ç¥å›¾è…¾ã€‚", h:"[é”¦å›Š] è‚ç«æ—ºç››ã€‚ç”Ÿæ°”å®¹æ˜“é•¿ç»“èŠ‚ï¼Œå­¦ä¼šä½›ç³»ç”Ÿæ´»ã€‚" } },
        "æ­£å°æ ¼": { name: "ğŸ“œ åœ£è´¤å¯¼å¸ˆ", tags: ["SR","æ…ˆæ‚²"], icon: "ğŸ™", slogan: "ä½†è¡Œå¥½äº‹ï¼Œè«é—®å‰ç¨‹ã€‚", male: { c:"[å¤©èµ‹] è´µäººæ‰¶æŒã€‚é€‚åˆæ–‡æ•™ã€å…¬ç›Šã€é¡¾é—®ã€‚æ˜¯å›¢é˜Ÿçš„ç²¾ç¥é¢†è¢–ã€‚", w:"[è´¢å¯Œ] æ¸…è´µä¹‹è´¢ã€‚åå£°æ¢é’±ï¼Œé€‚åˆèººèµšã€ç‰ˆç¨æˆ–ç¨³å®šé€€ä¼‘é‡‘ã€‚", l:"[ç¾ç»Š] ä¾èµ–ä¼´ä¾£ã€‚ä¹ æƒ¯è¢«ç…§é¡¾ï¼Œå¯»æ‰¾å¸¦æ¯æ€§å…‰è¾‰çš„ä¼´ä¾£ã€‚", k:"[ä¼ æ‰¿] çŸ¥ä¹¦è¾¾ç†ã€‚å®½æ¾æ•™è‚²ï¼Œæ³¨é‡å“å¾·ä¿®å…»ã€‚", h:"[é”¦å›Š] é¢„é˜²è‚¥èƒ–ã€‚å¿ƒå®½ä½“èƒ–ï¼Œæ³¨æ„ä¸‰é«˜ï¼Œå¤šåŠ¨å°‘å®…ã€‚" }, female: { c:"[å¤©èµ‹] å²æœˆé™å¥½ã€‚å¿ƒæ€å¹³å’Œï¼ŒèŒåœºç™½æœˆå…‰ï¼Œå—é¢†å¯¼å® çˆ±ã€‚", w:"[è´¢å¯Œ] å¤©ç”Ÿç¦åˆ†ã€‚æ€»æœ‰äººä¸ºä½ ä¹°å•ï¼Œç¦æ°”å¤§äºè´¢æ°”ã€‚", l:"[ç¾ç»Š] è¢«å® æººçš„ä¸€ç”Ÿã€‚å«å¾—å¥½æ˜¯æ¦‚ç‡äº‹ä»¶ï¼Œäº«å—è¢«æ§åœ¨æ‰‹å¿ƒã€‚", k:"[ä¼ æ‰¿] äº²å­å¦‚å‹ã€‚å­©å­å¿ƒç†å¥åº·ï¼Œæ™šå¹´äº«å—å¤©ä¼¦ä¹‹ä¹ã€‚", h:"[é”¦å›Š] æ³¨æ„æ’æ¹¿ã€‚ä»£è°¢è¾ƒæ…¢ï¼Œå¤šè¿åŠ¨å‡ºæ±—æœ‰ç›Šèº«å¿ƒã€‚" } },
        "äº”è¡Œæµé€š": { name: "â˜¯ï¸ å¤ªæå®—å¸ˆ", tags: ["SSR","å…¨èƒ½"], icon: "ğŸ§˜", slogan: "åˆšä¸å¯ä¹…ï¼ŒæŸ”ä¸å¯å®ˆã€‚", male: { c:"[å¤©èµ‹] å…­è¾¹å½¢æˆ˜å£«ã€‚æ— çŸ­æ¿ï¼Œé€‚åˆå¤§æ ¼å±€ç®¡ç†åŠèµ„æºç»Ÿç­¹ã€‚", w:"[è´¢å¯Œ] ç¨³å¦‚æ³°å±±ã€‚æŠ—é£é™©èƒ½åŠ›æœ€é«˜ï¼Œè´¢å¯Œå¦‚é›ªçƒç¨³æ­¥æ»šåŠ¨ã€‚", l:"[ç¾ç»Š] ç»†æ°´é•¿æµã€‚å©šå§»æ— ç‹—è¡€ï¼Œè¿½æ±‚å¹³æ·¡è€Œé•¿ä¹…çš„å¹¸ç¦ã€‚", k:"[ä¼ æ‰¿] å­å­ä¼ æ‰¿ã€‚å­©å­èº«å¿ƒå¥åº·ï¼Œå®¶é£å’Œè°ç¨³å®šã€‚", h:"[é”¦å›Š] é•¿å¯¿ä¹‹åŸºã€‚åªè¦ä¸ä½œæ­»ï¼Œå¤§æ¦‚ç‡æ˜¯ç™¾å²è€äººã€‚" }, female: { c:"[å¤©èµ‹] ä»¥æŸ”å…‹åˆšã€‚æé«˜çš„æ²Ÿé€šæƒ…å•†ï¼Œèƒ½åŒ–è§£ä¸€åˆ‡çŸ›ç›¾ã€‚", w:"[è´¢å¯Œ] éšå½¢å¯Œè±ªã€‚ä¸ç¼ºé’±ï¼Œä¹Ÿä¸æ˜¾æ‘†ã€‚ç”Ÿæ´»è´¨é‡æé«˜ã€‚", l:"[ç¾ç»Š] æ—ºå¤«æ—ºå®¶ã€‚ä½ æ˜¯å®¶é‡Œçš„æ¶¦æ»‘å‰‚ï¼Œå…¨å®¶äººéƒ½ç¦»ä¸å¼€ä½ ã€‚", k:"[ä¼ æ‰¿] é™ªä¼´æ•™è‚²ã€‚å­©å­æƒ…å•†é«˜ï¼Œç¤¾äº¤èƒ½åŠ›å¼ºï¼Œæ™šå¹´ç¦åšã€‚", h:"[é”¦å›Š] å…»ç”Ÿè¾¾äººã€‚å¤©ç”Ÿæ‡‚å¾—ä¿å…»ï¼Œå®¹é¢œä¸æ˜“è€ã€‚" } },
        "æ‚æ ¼": { name: "ğŸŒ± æ½œé¾™å‹¿ç”¨", tags: ["N","æ½œåŠ›"], icon: "ğŸŒ±", slogan: "æ—¶è¿æœªåˆ°ï¼Œæ½œå¿ƒæ·±è€•ã€‚", male: { c:"[å¤©èµ‹] å¤šé¢æ‰‹ã€‚ç»¼åˆç´ è´¨ä¸é”™ï¼Œé€‚åˆåœ¨ç¨³å®šæœºæ„æ·±è€•ã€‚", w:"[è´¢å¯Œ] å‹¤åŠ³å°åº·ã€‚é ä¸“ä¸šæ‰‹è‰ºè¿‡æ—¥å­ï¼Œå®‰ç¨³æ— å¤§é£æµªã€‚", l:"[ç¾ç»Š] å¹³æ·¡æ˜¯çœŸã€‚å©šå§»ç”Ÿæ´»æ³¢æ¾œä¸æƒŠï¼Œè¿½æ±‚é™ªä¼´ã€‚", k:"[ä¼ æ‰¿] å­©å­å¹³å®‰ã€‚å¯¹å­©å­æœŸå¾…ä¸é«˜ï¼Œå¥åº·å³æ˜¯ç¦åˆ†ã€‚", h:"[é”¦å›Š] å¤šé”»ç‚¼ã€‚èº«ä½“æ˜¯é©å‘½æœ¬é’±ï¼Œåˆ«é€æ”¯ã€‚" }, female: { c:"[å¤©èµ‹] è¸å®åå‹¤ã€‚è®¤çœŸè´Ÿè´£ï¼Œè™½ç„¶ä¸å‡ºå½©ä½†è®©äººæ— æ¯”æ”¾å¿ƒã€‚", w:"[è´¢å¯Œ] èŠ‚ä¿­å­˜é’±ã€‚è´¢å¯Œæ˜¯çœå‡ºæ¥çš„ï¼Œé€‚åˆç¨³å¥è´¢åŠ¡ã€‚", l:"[ç¾ç»Š] ä¾é ä¼´ä¾£ã€‚æ‰¾ä¸ªè€å®äººï¼Œå®‰ç¨³è¿‡å®Œè¿™ä¸€ç”Ÿã€‚", k:"[ä¼ æ‰¿] æ…ˆæ¯å¿ƒã€‚ä¸ºå­©å­æ“å¿ƒå¤šï¼Œæ³¨æ„å¹³è¡¡è‡ªæˆ‘ã€‚", h:"[é”¦å›Š] ä¿è¯ç¡çœ ã€‚ä¸è¦æ€è™‘è¿‡é‡ï¼Œç®€å•ç”Ÿæ´»ã€‚" } }
    };

    const XIJI_RULES = {
        "é‡‘æ°´ä¼¤å®˜": { desc: "é‡‘ç”Ÿå†¬æœˆå¯’å†·ï¼Œå¿…è§ç«æš–å±€ã€‚å–œå®˜æ€ã€è´¢æ˜Ÿã€‚å¿Œé‡‘æ°´è¿‡æ—ºã€‚", joy: ["ğŸ”¥ ç« (å®˜æ€)","ğŸŒ² æœ¨ (è´¢æ˜Ÿ)"], taboo: ["ğŸ’§ æ°´ (ä¼¤å®˜)","â›°ï¸ åœŸ (åŸ‹é‡‘)"] },
        "é‡‘æ°´é£Ÿç¥": { desc: "é‡‘ç™½æ°´æ¸…ï¼Œæ‰åå‡ºä¼—ã€‚å–œç«è°ƒå€™ï¼Œå¿ŒåœŸå…‹é£Ÿã€‚æ°´å†·é‡‘å¯’éœ€ç«æ•‘ã€‚", joy: ["ğŸ”¥ ç« (è°ƒå€™)","ğŸŒ² æœ¨ (è´¢æ˜Ÿ)"], taboo: ["â›°ï¸ åœŸ (æ­ç¥)","ğŸ’§ æ°´ (è¿‡å¯’)"] },
        "ä¼¤å®˜é…å°": { desc: "èº«å¼±ä¼¤æ—ºï¼Œæ°´å°ç”Ÿèº«åˆ¶ä¼¤ã€‚è´µä¸å¯è¨€ï¼Œæ€¥éœ€æ°´å°æ¶¦å±€ã€‚", joy: ["ğŸ’§ æ°´ (å°æ˜Ÿ)","ğŸŒ² æœ¨ (æ¯”åŠ«)"], taboo: ["â›°ï¸ åœŸ (è´¢æ˜Ÿ)","ğŸ”¥ ç« (ä¼¤å®˜)"] },
        "ä¼¤å®˜åˆæ€": { desc: "ä¼¤æ€ä¸¤æ—ºï¼Œåˆæ€ä¸ºæƒã€‚ä»¥æ‰‹æ®µè°‹ç•¥å–èƒœã€‚å–œå°æŠ¤èº«ã€‚", joy: ["ğŸ“œ å°æ˜Ÿ","ğŸ’ª æ¯”åŠ«"], taboo: ["ğŸ’° è´¢æ˜Ÿ","ğŸ—¡ï¸ å®˜æ€"] },
        "é£Ÿç¥åˆ¶æ€": { desc: "ä¸ƒæ€å¾—ä½ï¼Œé£Ÿç¥åˆ¶ä¹‹ã€‚è‹±é›„èƒ†ç•¥ï¼Œæƒå¨é‡ã€‚å–œèº«å¼ºã€‚", joy: ["ğŸ¨ é£Ÿç¥","ğŸ“œ å°æ˜Ÿ"], taboo: ["ğŸ’° è´¢æ˜Ÿ","ğŸ—¡ï¸ ä¸ƒæ€"] },
        "æ­£è´¢æ ¼": { desc: "è´¢æ˜Ÿå½“ä»¤ã€‚èº«å¼ºä»»è´¢ï¼Œèº«å¼±å–œå°æ¯”æ‰¶æŒã€‚æ ¼å±€å¹³ç¨³ã€‚", joy: ["ğŸ’ª æ¯”åŠ«","ğŸ“œ å°æ˜Ÿ"], taboo: ["ğŸ’° è´¢æ˜Ÿ (èº«å¼±)","ğŸ—¡ï¸ å®˜æ€"] },
        "ä¸ƒæ€æ ¼": { desc: "æ€ç¥å¨ä¸¥ã€‚éœ€åˆ¶åŒ–æ–¹æˆå¤§æ ¼ã€‚æ— åˆ¶åˆ™å‹åŠ›é‡é‡ï¼Œå¤§èµ·å¤§è½ã€‚", joy: ["ğŸ¨ é£Ÿä¼¤ (åˆ¶)","ğŸ“œ å°æ˜Ÿ (åŒ–)"], taboo: ["ğŸ’° è´¢æ˜Ÿ (åŠ©æ€)"] },
        "äº”è¡Œæµé€š": { desc: "äº”è¡Œä¸­å’Œï¼Œæ°”è´¯é•¿è™¹ã€‚ç™¾ç—…ä¸ä¾µï¼Œç¾å„éš¾å…¥ã€‚", joy: ["äº”è¡Œå¹³è¡¡"], taboo: ["å†²æˆ˜å…‹æŸ"] },
        "æ‚æ ¼": { desc: "æ ¼å±€æœªæ¸…ï¼Œå…¨å‡­æ‰¶æŠ‘ã€‚é‡ç‚¹çœ‹è°ƒå€™ä¸é€šå…³ã€‚", joy: ["æ‰¶åŠ©ç”¨ç¥"], taboo: ["ä¼¤å®³ç”¨ç¥"] }
    };

    // --- é€»è¾‘ç®—æ³• ---
    window.onload = () => {
        const now = new Date();
        const str = new Date(now.getTime() - now.getTimezoneOffset() * 60000).toISOString().slice(0, 16);
        document.getElementById('birth-input').value = str;
    };

    function setGender(v, el) {
        currentGender = v;
        document.querySelectorAll('.g-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
    }

    function hasRoot(gan, pillars) {
        const roots = ROOT_MAP[gan] || [];
        return pillars.some(p => roots.includes(p.z));
    }

    function calcCommander(lunar, monthZhi) {
        const prevJie = lunar.getPrevJie();
        const pjSolar = prevJie.getSolar();
        const jieTime = new Date(pjSolar.getYear(), pjSolar.getMonth()-1, pjSolar.getDay(), pjSolar.getHour(), pjSolar.getMinute()).getTime();
        const birthTime = new Date(lunar.getSolar().getYear(), lunar.getSolar().getMonth()-1, lunar.getSolar().getDay(), lunar.getSolar().getHour(), lunar.getSolar().getMinute()).getTime();
        const diffDays = Math.floor((birthTime - jieTime) / (1000 * 60 * 60 * 24));
        const rules = SILING_RULES[monthZhi];
        let commander = rules[rules.length-1][0]; 
        let sum = 0;
        for (let r of rules) { sum += r[1]; if (diffDays < sum) { commander = r[0]; break; } }
        return { commander, diffDays };
    }

    function analyzeClimate(dm, mz, pillars) {
        const isWinter = ["äº¥","å­","ä¸‘"].includes(mz);
        const hasFire = pillars.some(p => WUXING_MAP[p.g] === 'ç«' || WUXING_MAP[p.z] === 'ç«');
        const hasWater = pillars.some(p => WUXING_MAP[p.g] === 'æ°´' || WUXING_MAP[p.z] === 'æ°´');
        const dmWx = WUXING_MAP[dm];
        
        if (dmWx === 'åœŸ' && isWinter && !hasFire) return { advice: "âš ï¸ æ°´å†·åœŸå†»ï¼Œéä¸™ç«ä¸å¯æ•‘ï¼æ ¼å±€éš¾æˆã€‚" };
        if (dmWx === 'é‡‘' && isWinter) {
            return { special: pillars.some(p => SHISHEN_MAP[dm][p.g] === 'ä¼¤å®˜') ? "é‡‘æ°´ä¼¤å®˜" : "é‡‘æ°´é£Ÿç¥" };
        }
        if (dmWx === 'æœ¨' && ["å¯…","å¯"].includes(mz) && hasFire) return { special: "æœ¨ç«é€šæ˜" };
        if (dmWx === 'æœ¨' && mz === 'å·³' && hasWater) return { special: "ä¼¤å®˜é…å°" };
        return { special: null };
    }

    function determinePattern(climate, pillars, dm, mz, cmd) {
        if (climate.special) return climate.special;
        const stems = [pillars[0].g, pillars[1].g, pillars[3].g];
        const gods = stems.map(s => SHISHEN_MAP[dm][s]);

        // 1. åˆ¶åŒ–ä¼˜å…ˆ (æ€æ ¼å˜ç§)
        if (gods.includes("ä¸ƒæ€")) {
            if (gods.includes("é£Ÿç¥") && stems.some(s => SHISHEN_MAP[dm][s]==="é£Ÿç¥" && hasRoot(s, pillars))) return "é£Ÿç¥åˆ¶æ€";
            if (gods.includes("ä¼¤å®˜")) return "ä¼¤å®˜åˆæ€";
            if (gods.includes("æ­£å°") || gods.includes("åå°")) return "æ€å°ç›¸ç”Ÿ";
        }
        // 2. ä¼¤å®˜å˜ç§
        if (gods.includes("ä¼¤å®˜")) {
            if (stems.some(s => SHISHEN_MAP[dm][s]==="ä¼¤å®˜" && hasRoot(s, pillars))) {
                if (gods.includes("æ­£å°") || gods.includes("åå°")) return "ä¼¤å®˜é…å°";
                if (gods.some(g => g && g.includes("è´¢"))) return "ä¼¤å®˜ç”Ÿè´¢";
                return "ä¼¤å®˜æ ¼";
            }
        }
        // 3. çœŸç¥/æœ¬æ°”
        if (stems.includes(cmd.commander)) {
            const g = SHISHEN_MAP[dm][cmd.commander];
            const m = {"æ­£è´¢":"æ­£è´¢æ ¼","åè´¢":"åè´¢æ ¼","ä¸ƒæ€":"ä¸ƒæ€æ ¼","æ­£å®˜":"æ­£å®˜æ ¼","æ­£å°":"æ­£å°æ ¼","åå°":"åå°æ ¼","é£Ÿç¥":"é£Ÿç¥æ ¼"};
            if (m[g]) return m[g];
        }
        const mainGod = SHISHEN_MAP[dm][ZHI_MAIN_QI[mz]];
        const fallback = {"æ¯”è‚©":"å»ºç¦„æ ¼","åŠ«è´¢":"æœˆåŠ«æ ¼","æ­£è´¢":"æ­£è´¢æ ¼","æ­£å®˜":"æ­£å®˜æ ¼","ä¸ƒæ€":"ä¸ƒæ€æ ¼","æ­£å°":"æ­£å°æ ¼","é£Ÿç¥":"é£Ÿç¥æ ¼","ä¼¤å®˜":"ä¼¤å®˜æ ¼"};
        return fallback[mainGod] || "æ‚æ ¼";
    }

    function startScan() {
        const timeStr = document.getElementById('birth-input').value;
        if (!timeStr) return alert("è¯·é€‰æ—¶é—´");
        try {
            const date = new Date(timeStr);
            const solar = Solar.fromYmdHms(date.getFullYear(), date.getMonth()+1, date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds());
            const lunar = solar.getLunar();
            const baziObj = lunar.getEightChar();
            baziObj.setSect(2);

            const pillars = [
                {t:'å¹´æŸ±', g:baziObj.getYearGan().toString(), z:baziObj.getYearZhi().toString()},
                {t:'æœˆæŸ±', g:baziObj.getMonthGan().toString(), z:baziObj.getMonthZhi().toString()},
                {t:'æ—¥æŸ±', g:baziObj.getDayGan().toString(), z:baziObj.getDayZhi().toString()},
                {t:'æ—¶æŸ±', g:baziObj.getTimeGan().toString(), z:baziObj.getTimeZhi().toString()}
            ];

            const dm = pillars[2].g;
            const mz = pillars[1].z;
            const cmd = calcCommander(lunar, mz);
            const climate = analyzeClimate(dm, mz, pillars);
            const pattern = determinePattern(climate, pillars, dm, mz, cmd);

            document.getElementById('result-area').style.display = 'block';
            renderUI(pattern, cmd, dm, climate, pillars);
            drawChart(pillars);
            document.getElementById('result-area').scrollIntoView({ behavior: 'smooth' });
        } catch (e) { alert("æ¨æ¼”ä¸­æ–­ï¼š" + e.message); console.error(e); }
    }

    function renderUI(key, cmd, dm, climate, pillars) {
        const data = GAME_DB[key] || GAME_DB["æ‚æ ¼"];
        const xiji = XIJI_RULES[key] || XIJI_RULES["æ‚æ ¼"];
        const detail = data[currentGender === 1 ? 'male' : 'female'];

        document.getElementById('role-icon').innerText = data.icon;
        document.getElementById('role-name').innerText = data.name;
        document.getElementById('role-slogan').innerText = data.slogan;
        document.getElementById('role-tags').innerHTML = `<span class="tag logic">[${key}]</span>` + data.tags.map(t => `<span class="tag ssr">${t}</span>`).join('');
        document.getElementById('siling-text').innerText = `å½“ä»¤çœŸç¥ï¼š${cmd.commander} (${SHISHEN_MAP[dm][cmd.commander]}) Â· æ‰§æ”¿ç¬¬ ${cmd.diffDays} å¤©`;
        
        let reason = xiji.desc;
        if (climate.advice) reason += ` <br><span style='color:var(--primary);font-weight:bold;'>${climate.advice}</span>`;
        document.getElementById('pattern-reason').innerHTML = reason;
        document.getElementById('txt-joy').innerText = xiji.joy.join(" ");
        document.getElementById('txt-taboo').innerText = xiji.taboo.join(" ");

        let p_html = '';
        pillars.forEach(p => {
            const god = p.t.includes('æ—¥æŸ±') ? 'æ—¥ä¸»' : (SHISHEN_MAP[dm][p.g] || "");
            p_html += `<div class="col"><div class="c-head">${p.t}</div><div class="c-god">${god}</div><div class="c-char ${WX_COLOR[WUXING_MAP[p.g]]}">${p.g}</div><div class="c-char ${WX_COLOR[WUXING_MAP[p.z]]}">${p.z}</div><span class="c-cs">${CHANGSHENG_TABLE[p.g][p.z] || ""}</span></div>`;
        });
        document.getElementById('pillars-box').innerHTML = p_html;

        document.getElementById('guide-content').innerHTML = `
            <div class="guide-item"><div class="guide-title">âš”ï¸ äº‹ä¸šä¸å¤©èµ‹</div><div class="guide-text">${detail.c}</div></div>
            <div class="guide-item"><div class="guide-title">ğŸ’° è´¢å¯Œä¸é€»è¾‘</div><div class="guide-text">${detail.w}</div></div>
            <div class="guide-item"><div class="guide-title">ğŸ’ æƒ…æ„Ÿä¸ç¾ç»Š</div><div class="guide-text">${detail.l}</div></div>
            <div class="guide-item"><div class="guide-title">ğŸŒ± åä»£ä¸ä¼ æ‰¿</div><div class="guide-text">${detail.k}</div></div>
            <div class="guide-item"><div class="guide-title">â¤ï¸ å¥åº·ä¸é”¦å›Š</div><div class="guide-text">${detail.h}</div></div>
        `;
    }

    function drawChart(pillars) {
        const canvas = document.getElementById('energy-canvas');
        const ctx = canvas.getContext('2d');
        const w = canvas.parentElement.offsetWidth, h = canvas.parentElement.offsetHeight;
        canvas.width = w; canvas.height = h;

        const counts = {'é‡‘':0,'æœ¨':0,'æ°´':0,'ç«':0,'åœŸ':0};
        pillars.forEach(p => { counts[WUXING_MAP[p.g]]++; counts[WUXING_MAP[p.z]]++; });
        
        ctx.fillStyle = "#0d0d12"; ctx.fillRect(0,0,w,h);
        const cx = w/2, cy = h/2, r = 60;
        ctx.strokeStyle = "#333";
        for(let j=1; j<=3; j++) {
            ctx.beginPath();
            for(let i=0; i<5; i++) {
                const a = (Math.PI*2/5)*i - Math.PI/2;
                ctx.lineTo(cx + Math.cos(a)*r*(j/3), cy + Math.sin(a)*r*(j/3));
            }
            ctx.closePath(); ctx.stroke();
        }

        ctx.fillStyle = "rgba(0, 255, 242, 0.25)"; ctx.strokeStyle = "#00fff2"; ctx.lineWidth = 2;
        ctx.beginPath();
        Object.keys(counts).forEach((k, i) => {
            const a = (Math.PI*2/5)*i - Math.PI/2;
            const l = (counts[k]/8)*r*3; 
            ctx.lineTo(cx + Math.cos(a)*l, cy + Math.sin(a)*l);
            ctx.save();
            ctx.fillStyle = "#fff"; ctx.font = "11px Arial";
            ctx.fillText(k, cx + Math.cos(a)*(r+15)-5, cy + Math.sin(a)*(r+15)+5);
            ctx.restore();
        });
        ctx.closePath(); ctx.fill(); ctx.stroke();
    }
</script>
</body>
</html>
