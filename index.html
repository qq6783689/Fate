<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å‘½è¿é»‘ç›’ Pro Max Â· å¤©å‘½å¡ç‰Œç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.12/lunar.min.js"></script>
    <style>
        :root {
            /* èµ›åšæœ‹å…‹/æ¸¸æˆé£é…è‰² */
            --primary: #ff0055;      /* æ”»å‡»/ç…æ°” */
            --accent: #00f2ea;       /* ç§‘æŠ€/æ™ºæ…§ */
            --bg-dark: #0f0f13;      /* æ·±æ¸Šé»‘ */
            --card-bg: #1a1a24;      /* å¡ç‰Œåº•è‰² */
            --text-main: #e0e0e0;
            --text-sub: #a0a0b0;
            --gold: #ffd700;         /* ç¨€æœ‰åº¦ */
            --border-radius: 12px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            margin: 0; padding: 20px 10px;
            min-height: 100vh;
            background-image: 
                linear-gradient(rgba(15, 15, 19, 0.9), rgba(15, 15, 19, 0.9)),
                url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80');
            background-size: cover;
            background-attachment: fixed;
            display: flex; justify-content: center;
        }

        .container { width: 100%; max-width: 650px; padding-bottom: 80px; }

        /* æ¸¸æˆåŒ–æ ‡é¢˜ */
        .header { text-align: center; margin-bottom: 30px; text-shadow: 0 0 10px var(--primary); }
        .header h1 { 
            font-size: 2rem; font-weight: 900; margin: 0; letter-spacing: 3px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .level-tag { 
            display: inline-block; padding: 4px 12px; border: 1px solid var(--accent); 
            border-radius: 20px; font-size: 0.8rem; color: var(--accent); margin-top: 10px;
            box-shadow: 0 0 10px rgba(0,242,234,0.3);
        }

        /* éœ“è™¹å¡ç‰Œå®¹å™¨ */
        .card {
            background: rgba(26, 26, 36, 0.95);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 20px; margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
            position: relative; overflow: hidden;
        }
        /* ç¨€æœ‰åº¦è¾¹æ¡†å…‰æ•ˆ */
        .card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--accent));
        }

        /* è¾“å…¥åŒº */
        .input-group { margin-bottom: 20px; }
        .label { color: var(--accent); font-size: 0.9rem; margin-bottom: 8px; display: block; text-transform: uppercase; letter-spacing: 1px; }
        
        .gender-switch { display: flex; gap: 15px; }
        .g-btn {
            flex: 1; padding: 12px; text-align: center; border: 1px solid #333; border-radius: 8px;
            cursor: pointer; transition: 0.3s; color: #666; font-weight: bold; background: #111;
        }
        .g-btn.active {
            border-color: var(--primary); color: #fff; background: rgba(255, 0, 85, 0.2);
            box-shadow: 0 0 15px rgba(255, 0, 85, 0.4);
        }

        input[type="datetime-local"] {
            width: 100%; padding: 12px; background: #111; border: 1px solid #333;
            color: #fff; border-radius: 8px; font-size: 1rem; outline: none;
        }
        input:focus { border-color: var(--accent); box-shadow: 0 0 10px rgba(0,242,234,0.2); }

        .btn-calc {
            width: 100%; padding: 15px; font-size: 1.1rem; font-weight: bold;
            background: linear-gradient(45deg, var(--primary), #8000ff);
            border: none; color: #fff; border-radius: 8px; cursor: pointer;
            text-transform: uppercase; letter-spacing: 2px;
            transition: transform 0.1s; position: relative; overflow: hidden;
        }
        .btn-calc:active { transform: scale(0.98); }
        .btn-calc::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: rotate(45deg); animation: shine 3s infinite;
        }
        @keyframes shine { 0% { left: -100%; } 100% { left: 100%; } }

        /* ç»“æœå±•ç¤ºåŠ¨ç”» */
        #result-area { display: none; animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { from { opacity: 0; transform: scale(0.95) translateY(20px); } to { opacity: 1; transform: scale(1) translateY(0); } }

        /* æ’ç›˜ç½‘æ ¼ */
        .pillars-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .pillar {
            background: #222; border-radius: 8px; padding: 15px 5px; text-align: center;
            border: 1px solid #333; position: relative;
        }
        .p-head { font-size: 0.7rem; color: #666; margin-bottom: 5px; text-transform: uppercase; }
        .god-tag { font-size: 0.7rem; color: var(--accent); margin-bottom: 5px; height: 16px; }
        .char { font-family: "KaiTi", serif; font-size: 1.8rem; font-weight: bold; line-height: 1.2; text-shadow: 0 2px 5px rgba(0,0,0,0.5); }
        .cs-tag { font-size: 0.7rem; margin-top: 5px; padding: 2px 6px; background: #111; border-radius: 4px; color: #888; display: inline-block; }
        .cs-strong { color: var(--gold); border: 1px solid rgba(255, 215, 0, 0.3); }

        /* äº”è¡Œè‰² */
        .wx-é‡‘ { color: #ffeaa7; } .wx-æœ¨ { color: #55efc4; } .wx-æ°´ { color: #74b9ff; } .wx-ç« { color: #ff7675; } .wx-åœŸ { color: #a29bfe; }

        /* è§’è‰²å¡ç‰‡å¤´éƒ¨ */
        .role-header { display: flex; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; margin-bottom: 20px; }
        .role-icon { 
            width: 60px; height: 60px; background: #222; border-radius: 12px; 
            display: flex; align-items: center; justify-content: center; font-size: 30px;
            border: 2px solid var(--gold); box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
            margin-right: 15px;
        }
        .role-info h2 { margin: 0; font-size: 1.4rem; color: #fff; }
        .role-tags { display: flex; gap: 8px; margin-top: 5px; }
        .tag { font-size: 0.7rem; padding: 2px 8px; border-radius: 4px; background: #333; color: #aaa; }
        .tag.ssr { background: linear-gradient(45deg, #ff0055, #ffcc00); color: #fff; font-weight: bold; }

        /* è¯¦ç»†è§£é‡Šéƒ¨åˆ† */
        .explain-box { margin-bottom: 25px; }
        .exp-title { 
            color: var(--accent); font-size: 1rem; font-weight: bold; margin-bottom: 10px; 
            display: flex; align-items: center; gap: 8px;
        }
        .exp-content { 
            background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; 
            font-size: 0.95rem; line-height: 1.7; color: #ddd; border-left: 3px solid var(--gray);
        }
        .exp-content strong { color: #fff; }

        /* æŠ€èƒ½æ¡é£æ ¼ */
        .skill-bar { display: flex; align-items: center; margin-bottom: 8px; }
        .skill-name { width: 80px; font-size: 0.8rem; color: #aaa; }
        .progress { flex: 1; height: 6px; background: #333; border-radius: 3px; overflow: hidden; margin: 0 10px; }
        .progress-fill { height: 100%; background: var(--success); width: 50%; border-radius: 3px; }
        .skill-val { width: 30px; font-size: 0.8rem; color: #fff; text-align: right; }

        /* æ„è±¡ç”»å¸ƒ */
        canvas { width: 100%; height: 180px; border-radius: 8px; opacity: 0.8; margin-bottom: 15px; }

        /* æ ¸å¿ƒæ°”æ•°ç›’å­ */
        .core-box { 
            background: linear-gradient(135deg, rgba(255, 71, 87, 0.1), rgba(0, 0, 0, 0)); 
            border: 1px solid rgba(255, 71, 87, 0.3);
            padding: 15px; border-radius: 8px; font-size: 0.9rem; line-height: 1.6; color: #ffcccb;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>å‘½è¿é»‘ç›’ <span style="font-size:0.5em; vertical-align:top;">PRO MAX</span></h1>
        <div class="level-tag">SYSTEM ONLINE: READY TO SCAN</div>
    </div>

    <div class="card">
        <div class="input-group">
            <span class="label">é€‰æ‹©è§’è‰²æ€§åˆ« / GENDER SELECT</span>
            <div class="gender-switch">
                <div class="g-btn active" onclick="setGender(1, this)">ä¹¾é€  (Male)</div>
                <div class="g-btn" onclick="setGender(0, this)">å¤é€  (Female)</div>
            </div>
        </div>
        <div class="input-group">
            <span class="label">è¾“å…¥å‡ºç”Ÿæ—¶é—´ / LOG IN DATE</span>
            <input type="datetime-local" id="birth-input">
        </div>
        <button class="btn-calc" onclick="startScan()">å¯åŠ¨å‘½è¿æ‰«æ</button>
    </div>

    <div id="result-area">
        <div class="card">
            <div class="role-header">
                <div class="role-icon" id="role-icon">ğŸ²</div>
                <div class="role-info">
                    <h2 id="role-name">æ­£åœ¨ç”Ÿæˆè§’è‰²...</h2>
                    <div class="role-tags" id="role-tags">
                        <span class="tag">Loading...</span>
                    </div>
                </div>
            </div>
            <canvas id="energy-canvas"></canvas>
            <div style="font-size:0.8rem; color:#666; text-align:center; font-style:italic;" id="role-slogan">...</div>
        </div>

        <div class="card">
            <span class="label">åŸºç¡€å±æ€§é¢æ¿ / BASIC STATS</span>
            <div class="pillars-grid" id="pillars-box"></div>
            
            <div style="margin-top:20px;">
                <span class="label">èƒ½é‡æ ¸å¿ƒ / ENERGY CORE</span>
                <div class="core-box" id="core-analysis"></div>
            </div>
        </div>

        <div class="card">
            <span class="label">å¤©å‘½é€šå…³æ”»ç•¥ / STRATEGY GUIDE</span>
            
            <div class="explain-box">
                <div class="exp-title">âš”ï¸ ä¸»çº¿ä»»åŠ¡ï¼šäº‹ä¸šä¸æˆå°±</div>
                <div class="exp-content" id="txt-career"></div>
            </div>

            <div class="explain-box">
                <div class="exp-title">ğŸ’° èµ„æºè·å–ï¼šè´¢å¯Œä¸èµ„äº§</div>
                <div class="exp-content" id="txt-wealth"></div>
            </div>

            <div class="explain-box">
                <div class="exp-title">ğŸ’ ç¾ç»Šç³»ç»Ÿï¼šæƒ…æ„Ÿä¸å©šå§»</div>
                <div class="exp-content" id="txt-love"></div>
            </div>

            <div class="explain-box">
                <div class="exp-title">ğŸŒ± ä¼ æ‰¿ç³»ç»Ÿï¼šå­å¥³ä¸æ•™è‚²</div>
                <div class="exp-content" id="txt-kids"></div>
            </div>

            <div class="explain-box">
                <div class="exp-title">â¤ï¸ ç”Ÿå‘½å€¼ï¼šå¥åº·ä¸çŠ¶æ€</div>
                <div class="exp-content" id="txt-health"></div>
            </div>
        </div>

        <div style="text-align:center; color:#444; font-size:12px; margin-top:30px;">
            Destiny Algorithm Â© 2025 Â· Verified by Master Gemini
        </div>
    </div>
</div>

<script>
    let currentGender = 1;

    // ==========================================================
    // é™æ€æ•°æ®å­—å…¸ (å†…ç½®é˜²å´©)
    // ==========================================================
    
    const WX_COLOR = { 'é‡‘':'wx-é‡‘', 'æœ¨':'wx-æœ¨', 'æ°´':'wx-æ°´', 'ç«':'wx-ç«', 'åœŸ':'wx-åœŸ' };
    const WUXING_MAP = {
        'ç”²':'æœ¨','ä¹™':'æœ¨','ä¸™':'ç«','ä¸':'ç«','æˆŠ':'åœŸ','å·±':'åœŸ','åºš':'é‡‘','è¾›':'é‡‘','å£¬':'æ°´','ç™¸':'æ°´',
        'å­':'æ°´','ä¸‘':'åœŸ','å¯…':'æœ¨','å¯':'æœ¨','è¾°':'åœŸ','å·³':'ç«','åˆ':'ç«','æœª':'åœŸ','ç”³':'é‡‘','é…‰':'é‡‘','æˆŒ':'åœŸ','äº¥':'æ°´'
    };

    const HIDDEN_GAN_MAP = {
        'å­':['ç™¸'], 'ä¸‘':['å·±','ç™¸','è¾›'], 'å¯…':['ç”²','ä¸™','æˆŠ'], 'å¯':['ä¹™'], 
        'è¾°':['æˆŠ','ä¹™','ç™¸'], 'å·³':['ä¸™','æˆŠ','åºš'], 'åˆ':['ä¸','å·±'], 'æœª':['å·±','ä¸','ä¹™'], 
        'ç”³':['åºš','å£¬','æˆŠ'], 'é…‰':['è¾›'], 'æˆŒ':['æˆŠ','è¾›','ä¸'], 'äº¥':['å£¬','ç”²']
    };

    const CS_MEANING = {
        "é•¿ç”Ÿ": "ç¨³å›º", "æ²æµ´": "é­…åŠ›", "å† å¸¦": "è¿›å–", "ä¸´å®˜": "å¼ºç››", 
        "å¸æ—º": "å·…å³°", "è¡°": "ç¨³é‡", "ç—…": "æ•æ„Ÿ", "æ­»": "æ²‰é™", 
        "å¢“": "å›¤ç§¯", "ç»": "é‡ç”Ÿ", "èƒ": "å¸Œæœ›", "å…»": "åŸ¹è‚²"
    };

    const CHANGSHENG_TABLE = {
        "ç”²": { "äº¥":"é•¿ç”Ÿ", "å­":"æ²æµ´", "ä¸‘":"å† å¸¦", "å¯…":"ä¸´å®˜", "å¯":"å¸æ—º", "è¾°":"è¡°", "å·³":"ç—…", "åˆ":"æ­»", "æœª":"å¢“", "ç”³":"ç»", "é…‰":"èƒ", "æˆŒ":"å…»" },
        "ä¹™": { "åˆ":"é•¿ç”Ÿ", "å·³":"æ²æµ´", "è¾°":"å† å¸¦", "å¯":"ä¸´å®˜", "å¯…":"å¸æ—º", "ä¸‘":"è¡°", "å­":"ç—…", "äº¥":"æ­»", "æˆŒ":"å¢“", "é…‰":"ç»", "ç”³":"èƒ", "æœª":"å…»" },
        "ä¸™": { "å¯…":"é•¿ç”Ÿ", "å¯":"æ²æµ´", "è¾°":"å† å¸¦", "å·³":"ä¸´å®˜", "åˆ":"å¸æ—º", "æœª":"è¡°", "ç”³":"ç—…", "é…‰":"æ­»", "æˆŒ":"å¢“", "äº¥":"ç»", "å­":"èƒ", "ä¸‘":"å…»" },
        "ä¸": { "é…‰":"é•¿ç”Ÿ", "ç”³":"æ²æµ´", "æœª":"å† å¸¦", "åˆ":"ä¸´å®˜", "å·³":"å¸æ—º", "è¾°":"è¡°", "å¯":"ç—…", "å¯…":"æ­»", "ä¸‘":"å¢“", "å­":"ç»", "äº¥":"èƒ", "æˆŒ":"å…»" },
        "æˆŠ": { "å¯…":"é•¿ç”Ÿ", "å¯":"æ²æµ´", "è¾°":"å† å¸¦", "å·³":"ä¸´å®˜", "åˆ":"å¸æ—º", "æœª":"è¡°", "ç”³":"ç—…", "é…‰":"æ­»", "æˆŒ":"å¢“", "äº¥":"ç»", "å­":"èƒ", "ä¸‘":"å…»" },
        "å·±": { "é…‰":"é•¿ç”Ÿ", "ç”³":"æ²æµ´", "æœª":"å† å¸¦", "åˆ":"ä¸´å®˜", "å·³":"å¸æ—º", "è¾°":"è¡°", "å¯":"ç—…", "å¯…":"æ­»", "ä¸‘":"å¢“", "å­":"ç»", "äº¥":"èƒ", "æˆŒ":"å…»" },
        "åºš": { "å·³":"é•¿ç”Ÿ", "åˆ":"æ²æµ´", "æœª":"å† å¸¦", "ç”³":"ä¸´å®˜", "é…‰":"å¸æ—º", "æˆŒ":"è¡°", "äº¥":"ç—…", "å­":"æ­»", "ä¸‘":"å¢“", "å¯…":"ç»", "å¯":"èƒ", "è¾°":"å…»" },
        "è¾›": { "å­":"é•¿ç”Ÿ", "äº¥":"æ²æµ´", "æˆŒ":"å† å¸¦", "é…‰":"ä¸´å®˜", "ç”³":"å¸æ—º", "æœª":"è¡°", "åˆ":"ç—…", "å·³":"æ­»", "è¾°":"å¢“", "å¯":"ç»", "å¯…":"èƒ", "ä¸‘":"å…»" },
        "å£¬": { "ç”³":"é•¿ç”Ÿ", "é…‰":"æ²æµ´", "æˆŒ":"å† å¸¦", "äº¥":"ä¸´å®˜", "å­":"å¸æ—º", "ä¸‘":"è¡°", "å¯…":"ç—…", "å¯":"æ­»", "è¾°":"å¢“", "å·³":"ç»", "åˆ":"èƒ", "æœª":"å…»" },
        "ç™¸": { "å¯":"é•¿ç”Ÿ", "å¯…":"æ²æµ´", "ä¸‘":"å† å¸¦", "å­":"ä¸´å®˜", "äº¥":"å¸æ—º", "æˆŒ":"è¡°", "é…‰":"ç—…", "ç”³":"æ­»", "æœª":"å¢“", "åˆ":"ç»", "å·³":"èƒ", "è¾°":"å…»" }
    };
    const STRONG_CS = ["é•¿ç”Ÿ", "å¸æ—º", "ä¸´å®˜", "å† å¸¦"]; 

    const SHISHEN_MAP = {
        "ç”²": { "ç”²":"æ¯”è‚©", "ä¹™":"åŠ«è´¢", "ä¸™":"é£Ÿç¥", "ä¸":"ä¼¤å®˜", "æˆŠ":"åè´¢", "å·±":"æ­£è´¢", "åºš":"ä¸ƒæ€", "è¾›":"æ­£å®˜", "å£¬":"åå°", "ç™¸":"æ­£å°" },
        "ä¹™": { "ä¹™":"æ¯”è‚©", "ç”²":"åŠ«è´¢", "ä¸":"é£Ÿç¥", "ä¸™":"ä¼¤å®˜", "å·±":"åè´¢", "æˆŠ":"æ­£è´¢", "è¾›":"ä¸ƒæ€", "åºš":"æ­£å®˜", "ç™¸":"åå°", "å£¬":"æ­£å°" },
        "ä¸™": { "ä¸™":"æ¯”è‚©", "ä¸":"åŠ«è´¢", "æˆŠ":"é£Ÿç¥", "å·±":"ä¼¤å®˜", "åºš":"åè´¢", "è¾›":"æ­£è´¢", "å£¬":"ä¸ƒæ€", "ç™¸":"æ­£å®˜", "ç”²":"åå°", "ä¹™":"æ­£å°" },
        "ä¸": { "ä¸":"æ¯”è‚©", "ä¸™":"åŠ«è´¢", "å·±":"é£Ÿç¥", "æˆŠ":"ä¼¤å®˜", "è¾›":"åè´¢", "åºš":"æ­£è´¢", "ç™¸":"ä¸ƒæ€", "å£¬":"æ­£å®˜", "ä¹™":"åå°", "ç”²":"æ­£å°" },
        "æˆŠ": { "æˆŠ":"æ¯”è‚©", "å·±":"åŠ«è´¢", "åºš":"é£Ÿç¥", "è¾›":"ä¼¤å®˜", "å£¬":"åè´¢", "ç™¸":"æ­£è´¢", "ç”²":"ä¸ƒæ€", "ä¹™":"æ­£å®˜", "ä¸™":"åå°", "ä¸":"æ­£å°" },
        "å·±": { "å·±":"æ¯”è‚©", "æˆŠ":"åŠ«è´¢", "è¾›":"é£Ÿç¥", "åºš":"ä¼¤å®˜", "ç™¸":"åè´¢", "å£¬":"æ­£è´¢", "ä¹™":"ä¸ƒæ€", "ç”²":"æ­£å®˜", "ä¸":"åå°", "ä¸™":"æ­£å°" },
        "åºš": { "åºš":"æ¯”è‚©", "è¾›":"åŠ«è´¢", "å£¬":"é£Ÿç¥", "ç™¸":"ä¼¤å®˜", "ç”²":"åè´¢", "ä¹™":"æ­£è´¢", "ä¸™":"ä¸ƒæ€", "ä¸":"æ­£å®˜", "æˆŠ":"åå°", "å·±":"æ­£å°" },
        "è¾›": { "è¾›":"æ¯”è‚©", "åºš":"åŠ«è´¢", "ç™¸":"é£Ÿç¥", "å£¬":"ä¼¤å®˜", "ä¹™":"åè´¢", "ç”²":"æ­£è´¢", "ä¸":"ä¸ƒæ€", "ä¸™":"æ­£å®˜", "å·±":"åå°", "æˆŠ":"æ­£å°" },
        "å£¬": { "å£¬":"æ¯”è‚©", "ç™¸":"åŠ«è´¢", "ç”²":"é£Ÿç¥", "ä¹™":"ä¼¤å®˜", "ä¸™":"åè´¢", "ä¸":"æ­£è´¢", "æˆŠ":"ä¸ƒæ€", "å·±":"æ­£å®˜", "åºš":"åå°", "è¾›":"æ­£å°" },
        "ç™¸": { "ç™¸":"æ¯”è‚©", "å£¬":"åŠ«è´¢", "ä¹™":"é£Ÿç¥", "ç”²":"ä¼¤å®˜", "ä¸":"åè´¢", "ä¸™":"æ­£è´¢", "å·±":"ä¸ƒæ€", "æˆŠ":"æ­£å®˜", "è¾›":"åå°", "åºš":"æ­£å°" }
    };

    const SILING_RULES = {
        'å¯…': [['æˆŠ',7], ['ä¸™',7], ['ç”²',16]], 'å¯': [['ç”²',10], ['ä¹™',20]], 'è¾°': [['ä¹™',9], ['ç™¸',3], ['æˆŠ',18]],
        'å·³': [['æˆŠ',5], ['åºš',9], ['ä¸™',16]], 'åˆ': [['ä¸™',10], ['å·±',9], ['ä¸',11]], 'æœª': [['ä¸',9], ['ä¹™',3], ['å·±',18]],
        'ç”³': [['æˆŠ',7], ['å£¬',7], ['åºš',16]], 'é…‰': [['åºš',10], ['è¾›',20]], 'æˆŒ': [['è¾›',9], ['ä¸',3], ['æˆŠ',18]],
        'äº¥': [['æˆŠ',7], ['ç”²',5], ['å£¬',18]], 'å­': [['å£¬',10], ['ç™¸',20]], 'ä¸‘': [['ç™¸',9], ['è¾›',3], ['å·±',18]]
    };

    // æ¸¸æˆåŒ–æ–‡æ¡ˆåº“ (æ‰©å……ç‰ˆ)
    const GAME_DB = {
        "ä¼¤å®˜åˆæ€": { 
            name: "âš¡ å±æœºç»ˆç»“è€… (Crisis Terminator)", 
            tags: ["SSR", "çˆ†å‘å‹", "é«˜æ™ºå•†", "é€†é£å±€"],
            icon: "ğŸ—¡ï¸",
            slogan: "â€œæ··ä¹±æ˜¯é˜¶æ¢¯ã€‚å½“åˆ«äººåœ¨ææƒ§æ—¶ï¼Œæ­£æ˜¯æˆ‘æ¥ç®¡æˆ˜åœºçš„æ—¶å€™ã€‚â€",
            male: { 
                c:"**[å¤©èµ‹ï¼šä¹±ä¸–æ­é›„]**<br>ä½ å¤©ç”Ÿè‡ªå¸¦â€œåéª¨â€ï¼Œå‘†æ¿çš„ä½“åˆ¶å’Œé‡å¤çš„å·¥ä½œä¼šå°å°ä½ çš„æ³•åŠ›ã€‚ä½ çš„ä¸»åœºåœ¨**å±æœºå…¬å…³ã€å¾‹å¸ˆè¾©æŠ¤ã€ç‰¹ç§é¡¾é—®ã€ç”šè‡³é»‘ç™½é€šåƒçš„ä¸­ä»‹**ã€‚è¶Šæ˜¯æ··ä¹±ã€é«˜å‹ã€æ²¡äººæ•¢æ¥çš„ç›˜ï¼Œè¶Šèƒ½æ¿€å‘ä½ çš„Sçº§æ½œèƒ½ã€‚åˆ«æ€•éº»çƒ¦ï¼Œéº»çƒ¦å°±æ˜¯ä½ çš„ç»éªŒåŒ…ã€‚", 
                w:"**[è¢«åŠ¨ï¼šæ å¤ºè€…]**<br>ä½ çš„è´¢å¯Œä¸é ç§¯æ”’ï¼Œé **â€œç‹©çŒâ€**ã€‚åˆ©ç”¨ä¿¡æ¯å·®ã€æŠ€æœ¯å£å’æˆ–èƒ†è¯†è¿›è¡Œé™ç»´æ‰“å‡»ã€‚çˆ†å‘åŠ›æå¼ºï¼Œå¯èƒ½ä¸‰å¹´ä¸å¼€å¼ ï¼Œå¼€å¼ åƒä¸‰å¹´ã€‚å»ºè®®é…ç½®â€œå›ºå®šèµ„äº§â€æŠ¤ç›¾ï¼Œé˜²æ­¢è´¢å¯Œæµå¤±è¿‡å¿«ã€‚", 
                l:"**[ç¾ç»Šï¼šç›¸çˆ±ç›¸æ€]**<br>ä½ çœ‹ä¸ä¸Šå‚»ç™½ç”œï¼Œåªæœ‰å¸¦ç‚¹åˆºã€æœ‰æ‰‹æ®µçš„å¥³æ€§æ‰èƒ½æ¿€èµ·ä½ çš„å¾æœæ¬²ã€‚ä½ çš„å©šå§»æ˜¯ä¸€åœº**â€œé«˜æ™ºå•†åšå¼ˆâ€**ï¼Œè™½ç„¶åµåµé—¹é—¹ï¼Œä½†å½¼æ­¤çµé­‚æ·±åº¦å¥‘åˆã€‚æ§åˆ¶æ¬²åˆ«å¤ªå¼ºï¼Œç»™å¯¹æ–¹ä¸€ç‚¹å‘¼å¸ç©ºé—´ã€‚", 
                k:"**[ä¼ æ‰¿ï¼šå›é€†å¤©æ‰]**<br>ä½ çš„åä»£å¤§æ¦‚ç‡é—ä¼ äº†ä½ çš„é«˜æ™ºå•†å’Œå›é€†ã€‚åˆ«ç”¨â€œå¬è¯â€æ¥è¦æ±‚ä»–ï¼Œé‚£æ˜¯æ‰¼æ€å¤©æ‰ã€‚å¼•å¯¼ä»–å»æç§‘ç ”ã€è‰ºæœ¯æˆ–ç«æŠ€ï¼Œä»–ä¼šæˆä¸ºä½ çš„éª„å‚²ã€‚", 
                h:"**[Debuffï¼šè¿‡è½½]**<br>å¤§è„‘å¸¸å¹´é«˜é€Ÿè¿è½¬ï¼Œå®¹æ˜“ç¥ç»è¡°å¼±ã€‚æ³¨æ„å¤´éƒ¨ã€çœ¼éƒ¨ä¿å…»ï¼Œä»¥åŠæ¿€è¿›è¿åŠ¨å¸¦æ¥çš„å¤–ä¼¤é£é™©ã€‚" 
            }, 
            female: { 
                c:"**[å¤©èµ‹ï¼šå¥³ç‹æ°”åœº]**<br>èŒåœºä¸Šçš„**â€œé“å¨˜å­â€**ã€‚å…¬å…³æ€»ç›‘ã€æ“ç›˜æ‰‹ã€ç”šè‡³åˆ›ä¸šé¢†è¢–ã€‚ä½ èƒ½æå®šæœ€éš¾ç¼ çš„å®¢æˆ·ï¼Œç”šè‡³è®©ç”·äººä»¬æ•¬ç•ä¸‰åˆ†ã€‚ä½ çš„æ­¦å™¨æ˜¯çŠ€åˆ©çš„è¨€è¾å’Œé›·å‰é£è¡Œçš„æ‰‹æ®µã€‚", 
                w:"**[è¢«åŠ¨ï¼šåæ°”å˜ç°]**<br>åæ°”è¶Šå¤§ï¼Œè´¢è¿è¶Šæ—ºã€‚é€‚åˆç»è¥ä¸ªäººIPï¼Œæˆ–è€…åˆ©ç”¨åœˆå±‚å½±å“åŠ›è¿›è¡Œèµ„æºç½®æ¢ã€‚ä½ é€‚åˆåšä¸€ä¸ªå¿«ä¹çš„â€œå®ˆè´¢å¥´â€ï¼ŒæŠŠèµšæ¥çš„é’±å˜æˆä¸åŠ¨äº§ï¼Œæ„å»ºå®‰å…¨æ„Ÿå£å’ã€‚", 
                l:"**[ç¾ç»Šï¼šæ…•å¼ºå¿ƒç†]**<br>ä½ æ¬£èµ**â€œçˆ¹ç³»â€**ç¡¬æ±‰æˆ–è¡Œä¸šå¤§ä½¬ã€‚æ™®é€šç”·äººå…¥ä¸äº†ä½ çš„çœ¼ã€‚å©šåä½ æ˜¯å®¶é‡Œçš„ä¸»å¿ƒéª¨ï¼Œä½†ä¹Ÿå®¹æ˜“å› ä¸ºå¤ªå¼ºåŠ¿è€Œè®©å¯¹æ–¹æœ‰å‹åŠ›ã€‚å­¦ä¼šåœ¨å®¶â€œå¸ç”²â€ï¼Œèƒ½è®©æ„Ÿæƒ…å‡æ¸©ã€‚", 
                k:"**[ä¼ æ‰¿ï¼šç²¾è‹±æ•™è‚²]**<br>ä½ å¯¹å­©å­æŠ•å…¥æå¤§ï¼ŒæœŸæœ›æé«˜ã€‚å­©å­å¾€å¾€æœ‰ç‰¹æ®Šæ‰è‰ºã€‚æ³¨æ„ä¸è¦æŠŠä½ çš„ç„¦è™‘æŠ•å°„ç»™å­©å­ã€‚", 
                h:"**[Debuffï¼šå†…è€—]**<br>æƒ…ç»ªæ³¢åŠ¨å¤§ï¼Œå®¹æ˜“å¯¼è‡´å†…åˆ†æ³Œå¤±è°ƒæˆ–å¦‡ç§‘é—®é¢˜ã€‚é€‚åº¦åŒ»ç¾ï¼Œå¤šåšç‘œä¼½ï¼Œä¿æŒèº«å¿ƒå¹³è¡¡ã€‚" 
            } 
        },
        "é£Ÿç¥åˆ¶æ€": { 
            name: "ğŸ›¡ï¸ é“è…•é©¯å…½å¸ˆ (Beast Tamer)", 
            tags: ["SR+", "æ§åˆ¶å‹", "å¨æœ›", "æŠ€æœ¯æµ"],
            icon: "ğŸ¦",
            slogan: "â€œæ„¤æ€’æ˜¯æ— ç”¨çš„ï¼Œåªæœ‰ç»å¯¹çš„åŠ›é‡å’Œè§„åˆ™æ‰èƒ½é©¯æœé‡å…½ã€‚â€",
            male: { 
                c:"**[å¤©èµ‹ï¼šä¸æ€’è‡ªå¨]**<br>ä½ ä¸éœ€è¦å¤§å¼å¤§å«ï¼Œä½ çš„ä¸“ä¸šèƒ½åŠ›å’Œæ·±é‚ƒæ°”åœºè¶³ä»¥è®©ä¼—äººæœä»ã€‚é€‚åˆ**å…¬æ£€æ³•ã€å¤–ç§‘åŒ»ç”Ÿã€æŠ€æœ¯æ€»ç›‘**ã€‚ä½ æ˜¯å›¢é˜Ÿçš„å®šæµ·ç¥é’ˆï¼Œä¸“é—¨è§£å†³é‚£äº›éœ€è¦â€œç¡¬ç¢°ç¡¬â€çš„æŠ€æœ¯éš¾é¢˜ã€‚", 
                w:"**[è¢«åŠ¨ï¼šèµ„å†åŠ æˆ]**<br>ä½ çš„è´¢å¯Œæ›²çº¿æ˜¯**â€œå¤§åæœŸå‹â€**ã€‚èµ„å†è¶Šè€ï¼Œå¨æœ›è¶Šé«˜ï¼Œæ”¶å…¥è¶Šç¨³ã€‚é æ‰‹è‰ºåƒé¥­ï¼Œé‡‘é¥­ç¢—ç«¯å¾—æœ€ç¨³ã€‚ä¸å»ºè®®ç›²ç›®è·Ÿé£ç‚’ä½œï¼ŒåšæŒä½ çš„ä¸“ä¸šä¸»ä¹‰ã€‚", 
                l:"**[ç¾ç»Šï¼šä¸€å®¶ä¹‹ä¸»]**<br>ä½ åœ¨å®¶ä¸­åœ°ä½æé«˜ï¼Œå¦»å­æ•¬é‡ä½ ï¼Œç”šè‡³æœ‰ç‚¹æ€•ä½ ã€‚ä½ æ˜¯å…¸å‹çš„ä¼ ç»Ÿå¤§ç”·äººï¼Œè™½ä¸å–„è¨€è¾ï¼Œä½†è´£ä»»æ„Ÿçˆ†æ£šã€‚å¤šç»™å®¶äººä¸€ç‚¹ç¬‘è„¸ï¼Œåˆ«æŠŠå·¥ä½œå¨ä¸¥å¸¦å›å®¶ã€‚", 
                k:"**[ä¼ æ‰¿ï¼šæ ‹æ¢ä¹‹æ]**<br>å­©å­è§„çŸ©æ‡‚äº‹ï¼Œå­¦ä¹ æˆç»©ä¼˜å¼‚ï¼Œä¸ç”¨ä½ æ“å¤ªå¤šå¿ƒã€‚æœªæ¥å¤šåŠèµ°ä»•é€”æˆ–å­¦æœ¯è·¯çº¿ã€‚", 
                h:"**[Debuffï¼šå¯Œè´µç—…]**<br>èº«ä½“åº•å­å¥½ï¼Œä½†å®¹æ˜“æ‘„å…¥è¿‡å‰©ã€‚é˜²ä¸‰é«˜ã€è„‚è‚ªè‚ã€‚åº”é…¬è™½å¤šï¼Œæƒœå‘½è¦ç´§ã€‚" 
            }, 
            female: { 
                c:"**[å¤©èµ‹ï¼šé€»è¾‘å¥³ç‹]**<br>ä¸å±‘äºå®«æ–—ï¼Œé ç¡¬å®åŠ›è¯´è¯ã€‚**è´¢åŠ¡æ€»ç›‘ã€å®¡è®¡ã€å­¦æœ¯å¸¦å¤´äºº**ã€‚ä½ çš„é€»è¾‘æ»´æ°´ä¸æ¼ï¼Œè®©ç«äº‰å¯¹æ‰‹æ‰¾ä¸åˆ°ç ´ç»½ã€‚ä½ æ˜¯è€æ¿æœ€ä¿¡ä»»çš„â€œé˜²ç«å¢™â€ã€‚", 
                w:"**[è¢«åŠ¨ï¼šCFO]**<br>ä½ æ˜¯å¤©ç”Ÿçš„ç†è´¢åœ£æ‰‹ã€‚ä¸ä»…èƒ½èµšé’±ï¼Œæ›´èƒ½ç®¡é’±ã€‚å®¶é‡Œçš„è´¢æ”¿å¤§æƒå¿…é¡»æ¡åœ¨ä½ æ‰‹é‡Œã€‚ä½ å¯¹æ•°å­—æ•æ„Ÿï¼ŒæŠ•èµ„çœ¼å…‰ç²¾å‡†ä¸”ç¨³å¥ã€‚", 
                l:"**[ç¾ç»Šï¼šä¸¥å¦»è‰¯æ¯]**<br>ç®¡è€å…¬åƒç®¡å­©å­ï¼Œè™½ç„¶æœ‰ç‚¹å•°å—¦ï¼Œä½†éƒ½æ˜¯ä¸ºäº†å®¶å¥½ã€‚ä¸ˆå¤«é€šå¸¸æ€§æ ¼æ¸©å’Œï¼Œæ„¿æ„å¬ä½ å®‰æ’ã€‚ä½ æ˜¯å®¶é‡Œçš„æ€»æŒ‡æŒ¥ã€‚", 
                k:"**[ä¼ æ‰¿ï¼šè´´å¿ƒæ£‰è¢„]**<br>å­å¥³ç¼˜åˆ†æä½³ï¼Œæ¯æ…ˆå­å­ã€‚æ™šå¹´èƒ½äº«å­å¥³çš„ç¦æ°”ã€‚", 
                h:"**[Debuffï¼šè‚ èƒƒæ•æ„Ÿ]**<br>å‹åŠ›å¤§æ—¶å®¹æ˜“èƒƒç—›ã€‚æ³¨æ„é¥®é£Ÿè§„å¾‹ï¼Œå°‘åƒç”Ÿå†·ã€‚" 
            } 
        },
        "ä¼¤å®˜ç”Ÿè´¢": { 
            name: "ğŸ’¸ ç‚¼é‡‘æœ¯å£« (Alchemist)", 
            tags: ["SSR", "æ™ºè°‹ç³»", "åˆ›é€ ", "é«˜æ”¶ç›Š"],
            icon: "âš—ï¸",
            slogan: "â€œä¸‡ç‰©çš†å¯äº¤æ˜“ã€‚åªè¦ç»™æˆ‘ä¸€ä¸ªæ”¯ç‚¹ï¼Œæˆ‘èƒ½æŠŠç¨»è‰å–æˆé‡‘æ¡ã€‚â€",
            male: { 
                c:"**[å¤©èµ‹ï¼šç‚¹çŸ³æˆé‡‘]**<br>åƒä¸‡åˆ«å»æ‰“æ­»å·¥ï¼ä½ æ˜¯**åˆ›ä¸šã€åˆ›æ„ã€è¥é”€**çš„å¤©æ‰ã€‚ä½ çš„è„‘å­å°±æ˜¯å°é’æœºï¼Œæ€»èƒ½å‘ç°åˆ«äººçœ‹ä¸åˆ°çš„å•†æœºã€‚é€‚åˆç§‘æŠ€ã€åª’ä½“ã€ç”µå•†ç­‰è½»èµ„äº§è¡Œä¸šã€‚", 
                w:"**[è¢«åŠ¨ï¼šç°é‡‘æµ]**<br>é’±å¯¹ä½ æ¥è¯´æ˜¯æµåŠ¨çš„å·¥å…·ã€‚èµšé’±å¿«ï¼ŒèŠ±é’±ä¹Ÿå¿«ã€‚ä½ çš„è´¢å¯Œåœ¨äº**â€œå‘¨è½¬â€**ã€‚å»ºè®®æŠŠèµšåˆ°çš„è™šé’±åŠæ—¶ç½®æ¢æˆæˆ¿äº§ã€é»„é‡‘ç­‰å®ç‰©ï¼Œé˜²æ­¢â€œè´¢æ¥è´¢å»ä¸€åœºç©ºâ€ã€‚", 
                l:"**[ç¾ç»Šï¼šé¢œæ§]**<br>ä½ å–œæ¬¢æ¼‚äº®ã€æ—¶å°šã€å¸¦å‡ºå»æœ‰é¢å­çš„ä¼´ä¾£ã€‚ä½†ä½ è„¾æ°”æœ‰ç‚¹æ€¥èºï¼Œå®¹æ˜“å¿½ç•¥å¯¹æ–¹æ„Ÿå—ã€‚éœ€è¦ä¸€ä¸ªèƒ½åŒ…å®¹ä½ ã€æˆ–è€…èƒ½é™ªä½ ä¸€èµ·ç–¯çš„ä¼´ä¾£ã€‚", 
                k:"**[ä¼ æ‰¿ï¼šè‡ªç”±çµé­‚]**<br>å­å¥³å¯èƒ½æ—©æ—©å‡ºå›½æˆ–å»å¤–åœ°å‘å±•ï¼Œä¸ä½ ç¼˜åˆ†ç•¥æ·¡ï¼Œä½†ä½ æä¾›çš„ç‰©è´¨æ”¯æŒéå¸¸åˆ°ä½ã€‚å½¼æ­¤ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ã€‚", 
                h:"**[Debuffï¼šçƒ§è„‘]**<br>æ€è™‘è¿‡é‡ï¼Œå®¹æ˜“å¤±çœ ã€è„±å‘ã€ç¥ç»è¡°å¼±ã€‚ç¡å‰å¿…é¡»å¼ºåˆ¶è‡ªå·±â€œå…³æœºâ€ã€‚" 
            }, 
            female: { 
                c:"**[å¤©èµ‹ï¼šè¶…çº§å¸¦è´§]**<br>æ‰åæ¨ªæº¢ï¼Œ**è‡ªåª’ä½“ã€ä¸»æ’­ã€è‡ªç”±æ’°ç¨¿äºº**ã€‚ä½ çš„è¡¨è¾¾èƒ½åŠ›å’Œæ„ŸæŸ“åŠ›æ˜¯æ ¸æ­¦å™¨ã€‚åªè¦ä½ å¼€å£ï¼Œå°±æ²¡æœ‰å–ä¸å‡ºå»çš„ä¸œè¥¿ã€‚åšæŒèµ°æŠ€æœ¯ã€ä¸“æ‰è·¯çº¿ã€‚", 
                w:"**[è¢«åŠ¨ï¼šè´­ç‰©ç‹‚]**<br>èµšé’±æ˜¯ä½ èƒ½åŠ›çš„è¯æ˜ï¼ŒèŠ±é’±æ˜¯ä½ è§£å‹çš„æ–¹å¼ã€‚å¿…é¡»å¼ºåˆ¶å‚¨è“„ï¼Œæˆ–è€…ä¹°ä¿é™©ã€ä¿¡æ‰˜ã€‚åšä¸€ä¸ªå¿«ä¹çš„â€œå®ˆè´¢å¥´â€æ˜¯ä½ æ™šå¹´å¹¸ç¦çš„ä¿éšœã€‚", 
                l:"**[ç¾ç»Šï¼šæŒ‘å‰”çœ¼å…‰]**<br>çœ¼å…‰æ¯’è¾£ï¼Œå«Œå¼ƒè€å…¬ç©·ã€ç¬¨ã€æ²¡å“ä½ã€‚è¿™å®¹æ˜“å¯¼è‡´å©šå§»æ³¢æŠ˜ã€‚å»ºè®®æ‰¾æˆç†Ÿç¨³é‡çš„â€œå¤§å”å‹â€ä¼´ä¾£ï¼Œæˆ–è€…æ™šå©šã€‚", 
                k:"**[ä¼ æ‰¿ï¼šæººçˆ±]**<br>å­©å­æ˜¯ä½ çš„è½¯è‚‹ï¼Œä¹Ÿæ˜¯ä½ å¥‹æ–—çš„åŠ¨åŠ›ã€‚æ³¨æ„åˆ«æŠŠå­©å­å® åäº†ã€‚", 
                h:"**[Debuffï¼šæ°”éƒ]**<br>æ³¨æ„ç”²çŠ¶è…ºã€ä¹³è…ºé—®é¢˜ã€‚å¤šå»æ—…æ¸¸ï¼Œæ¢ä¸ªç¯å¢ƒèƒ½æ²»ç™¾ç—…ã€‚" 
            } 
        },
        "å»ºç¦„æ ¼": { 
            name: "ğŸ° ç‹¬ç«‹é¢†ä¸» (Independent Lord)", 
            slogan: "â€œæ±‚äººä¸å¦‚æ±‚å·±ã€‚æˆ‘çš„é¢†åœŸï¼Œæˆ‘è¯´äº†ç®—ã€‚â€", 
            tags: ["SR", "å¦å…‹å‹", "ç¨³å¥", "è‡ªç«‹"],
            icon: "ğŸ—¿",
            male: { c:"äº‹å¿…èº¬äº²ï¼Œé—²ä¸ä¸‹æ¥ã€‚æŠ€æœ¯æ€»ç›‘ã€åˆä¼™äººã€‚é€‚åˆå¸¦é˜Ÿå†²é”‹ã€‚", w:"è¾›è‹¦é’±ï¼Œæ¯ä¸€åˆ†éƒ½æ˜¯æ±—æ°´ã€‚èº«æ—ºä»»è´¢ï¼Œä¸­æ™šå¹´å¤§å¯Œã€‚ä½†ä¹Ÿå®¹æ˜“è¢«åŠ«è´¢ã€‚", l:"å¤§ç”·å­ä¸»ä¹‰ï¼Œæ˜“å…‹å¦»ã€‚éœ€æ‰¾æ¸©æŸ”å¬è¯çš„è€å©†ã€‚", k:"å­©å­ç‹¬ç«‹ï¼Œæ”¾å…»å¼æ•™è‚²ã€‚", h:"èº«ä½“å£®å¦‚ç‰›ï¼Œç²¾åŠ›æ—ºã€‚æ³¨æ„è¿åŠ¨è¿‡é‡ã€‚" }, 
            female: { c:"æ¯”ç”·äººè¿˜æ‹¼ã€‚å¤–è¡¨æ–‡é™æŸ”å¼±ï¼Œå†…å¿ƒåˆšæ¯…å€”å¼ºã€‚ä¸å–œå¼„é™©ï¼Œç¨³æ‰ç¨³æ‰“ã€‚", w:"æåº¦å®ˆè´¢ï¼Œè´¢åç¦„åœ°ï¼ˆé’±åœ¨æ‰‹å¿ƒï¼‰ã€‚åªè¿›ä¸å‡ºï¼ŒåŒæ¶å€Ÿè´·ã€‚", l:"å®¹æ˜“é‡åˆ°æ€§æ ¼äº’è¡¥çš„ç¡¬æ±‰ã€‚è™½ç„¶å˜´ç¡¬ï¼Œä½†å¿ƒé‡Œä¾èµ–å¯¹æ–¹ã€‚", k:"åˆ©ç”Ÿè‚²ï¼Œå­©å­å¥åº·æ´»æ³¼ã€‚", h:"ç«æ°”å¤§ï¼Œæ˜“ä¸Šç«ã€‚æ³¨æ„ç”²çŠ¶è…ºã€‚" } 
        },
        "äº”è¡Œæµé€š": { 
            name: "â˜¯ï¸ å¹³è¡¡å¤§å¸ˆ (The Balancer)", 
            slogan: "â€œä¸åä¸å€šï¼Œä¸­åº¸ä¹‹é“ã€‚å¹³å¹³æ·¡æ·¡æ‰æ˜¯çœŸã€‚â€", 
            tags: ["R", "è¾…åŠ©å‹", "é•¿å¯¿", "å®‰ç¨³"],
            icon: "ğŸ§˜",
            male: { c:"ä¸‡é‡‘æ²¹ï¼Œç»¼åˆç®¡ç†ã€‚é€‚åº”åŠ›å¼ºã€‚", w:"å°åº·æ°´å¹³ï¼Œè¡£é£Ÿæ— å¿§ã€‚ç»ä¸å—ç©·ã€‚", l:"ç›¸æ•¬å¦‚å®¾ï¼Œå¹³æ·¡æ˜¯ç¦ã€‚", k:"å­©å­æ™®é€šå­é¡ºã€‚", h:"é•¿å¯¿æ— å¤§ç¾ã€‚" }, 
            female: { c:"æ–‡å‘˜åå‹¤ã€‚å®‰ç¨³ç¬¬ä¸€ã€‚", w:"ä¸ç¼ºé›¶èŠ±é’±ï¼Œç”Ÿæ´»æ»‹æ¶¦ã€‚", l:"è´¤å¦»è‰¯æ¯ï¼Œå®¶åº­æ¸©é¦¨ã€‚", k:"å­©å­ä¹–å·§ï¼Œäº²å­å…³ç³»å¥½ã€‚", h:"æ²¡å¤§æ¯›ç—…ï¼Œæ‡‚å…»ç”Ÿã€‚" } 
        }
    };

    // --- åˆå§‹åŒ– ---

    window.onload = function() {
        try {
            const now = new Date();
            const pad = (n) => n < 10 ? '0'+n : n;
            const str = `${now.getFullYear()}-${pad(now.getMonth()+1)}-${pad(now.getDate())}T${pad(now.getHours())}:${pad(now.getMinutes())}`;
            document.getElementById('birth-input').value = str;
        } catch(e) {}
        
        if (typeof Solar === 'undefined') {
            document.getElementById('error-msg').style.display = 'block';
        }
    };

    function setGender(val, el) {
        currentGender = val;
        document.querySelectorAll('.g-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
    }

    // --- ä¸»é€»è¾‘ ---
    
    function startScan() {
        const timeStr = document.getElementById('birth-input').value;
        if (!timeStr) return alert("è¯·é€‰æ‹©å‡ºç”Ÿæ—¶é—´");

        try {
            const date = new Date(timeStr);
            const solar = Solar.fromYmdHms(date.getFullYear(), date.getMonth()+1, date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds());
            const lunar = solar.getLunar();
            const bazi = lunar.getEightChar();
            bazi.setSect(2); 

            // 1. æ•°æ®å‡†å¤‡
            const yg = bazi.getYearGan().toString();  const yz = bazi.getYearZhi().toString();
            const mg = bazi.getMonthGan().toString(); const mz = bazi.getMonthZhi().toString();
            const dg = bazi.getDayGan().toString();   const dz = bazi.getDayZhi().toString();
            const hg = bazi.getTimeGan().toString();  const hz = bazi.getTimeZhi().toString();

            const pillars = [
                { t:'å¹´æŸ± (ROOT)', g:yg, z:yz },
                { t:'æœˆæŸ± (CAREER)', g:mg, z:mz },
                { t:'æ—¥æŸ± (SELF)', g:dg, z:dz },
                { t:'æ—¶æŸ± (OUTCOME)', g:hg, z:hz }
            ];

            // 2. æ¸²æŸ“
            renderPillars(pillars, dg);
            const cmdInfo = calcCommander(lunar, mz);
            const strengthInfo = analyzeGlobalStrength(cmdInfo, dg, mz, dz, hz);
            renderCoreQishu(strengthInfo, cmdInfo, dg, mz, pillars);
            drawArt(pillars, mz);
            
            // 3. æ ¸å¿ƒï¼šè°ƒç”¨æ¸¸æˆåŒ–æ ¼å±€æ–‡æ¡ˆ
            renderGamePattern(pillars, dg, mz);

            const resArea = document.getElementById('result-area');
            resArea.style.display = 'block';
            resArea.scrollIntoView({ behavior: 'smooth' });

        } catch (e) {
            console.error(e);
            alert("ç³»ç»Ÿè¿‡è½½ï¼Œè¯·é‡è¯•ï¼" + e.message);
        }
    }

    function renderPillars(pillars, dayMaster) {
        let html = '';
        pillars.forEach(p => {
            const god = p.t.includes('æ—¥æŸ±') ? 'æ—¥ä¸» (Me)' : (SHISHEN_MAP[dayMaster][p.g] || "");
            const cs = CHANGSHENG_TABLE[p.g][p.z] || "";
            const csClass = STRONG_CS.includes(cs) ? 'cs-tag cs-strong' : 'cs-tag';
            const csMeaning = CS_MEANING[cs] || "";
            const gWx = WUXING_MAP[p.g];
            const zWx = WUXING_MAP[p.z];

            html += `
                <div class="pillar">
                    <div class="p-head">${p.t}</div>
                    <div class="god-tag">${god}</div>
                    <div class="char ${WX_COLOR[gWx]}">${p.g}</div>
                    <div class="char ${WX_COLOR[zWx]}">${p.z}</div>
                    <div class="${csClass}">${cs} [${csMeaning}]</div>
                </div>
            `;
        });
        document.getElementById('pillars-box').innerHTML = html;
    }

    // æ‰‹åŠ¨è®¡ç®—å¸ä»¤
    function calcCommander(lunar, monthZhi) {
        const prevJie = lunar.getPrevJie();
        const pjSolar = prevJie.getSolar();
        const jieTime = new Date(pjSolar.getYear(), pjSolar.getMonth()-1, pjSolar.getDay(), pjSolar.getHour(), pjSolar.getMinute(), pjSolar.getSecond()).getTime();
        const bSolar = lunar.getSolar();
        const birthTime = new Date(bSolar.getYear(), bSolar.getMonth()-1, bSolar.getDay(), bSolar.getHour(), bSolar.getMinute(), bSolar.getSecond()).getTime();
        const diffDays = Math.floor((birthTime - jieTime) / (1000 * 60 * 60 * 24));
        
        const rules = SILING_RULES[monthZhi] || [];
        let commander = 'æœªçŸ¥';
        let daysSum = 0;
        for (let rule of rules) {
            daysSum += rule[1];
            if (diffDays < daysSum) {
                commander = rule[0];
                break;
            }
        }
        if (commander === 'æœªçŸ¥' && rules.length > 0) commander = rules[rules.length-1][0];
        return { commander, diffDays, prevJieName: prevJie.getName() };
    }

    function analyzeGlobalStrength(info, dm, mZ, dZ, hZ) {
        const dmWx = WUXING_MAP[dm];
        const mZWx = WUXING_MAP[mZ];
        const cmdWx = WUXING_MAP[info.commander];

        const isHelp = (tWx, sWx) => tWx===sWx || (tWx==="æœ¨"&&sWx==="ç«") || (tWx==="ç«"&&sWx==="åœŸ") || (tWx==="åœŸ"&&sWx==="é‡‘") || (tWx==="é‡‘"&&sWx==="æ°´") || (tWx==="æ°´"&&sWx==="æœ¨");
        const menWang = isHelp(mZWx, dmWx);
        const diWang = isHelp(cmdWx, dmWx);
        
        const dayCs = CHANGSHENG_TABLE[dm][dZ];
        const dayRootStrong = ["ä¸´å®˜", "å¸æ—º", "é•¿ç”Ÿ"].includes(dayCs);
        
        const hourCs = CHANGSHENG_TABLE[dm][hZ];
        const hourRootStrong = ["ä¸´å®˜", "å¸æ—º"].includes(hourCs);

        let finalStrong = false;
        let desc = "";

        if (dayRootStrong && hourRootStrong) {
            finalStrong = true;
            desc = "æ—¥æ—¶æ‰æ ¹ææ·±ï¼ˆä¸“ç¦„/å½’ç¦„ï¼‰ï¼Œæ— è§†æœˆä»¤è¡°å¼±ï¼Œç›´æ–­èº«å¼ºã€‚";
        } else if (menWang && diWang) {
            finalStrong = true;
            desc = "å¾—ä»¤å¾—æ°”ï¼Œæœˆä»¤æçº²æœ‰åŠ›ï¼Œèº«å¼ºã€‚";
        } else if (menWang && !diWang) {
            if (dayRootStrong) { finalStrong = true; desc = "è™½çœŸç¥å¤±ä»¤ï¼Œä½†å¾—æœˆä½“ä¸”æ—¥åå¼ºæ ¹ï¼Œåˆ¤èº«å¼ºã€‚"; }
            else { finalStrong = false; desc = "é—¨æ—ºåœ°è¡°ï¼Œæ—¥æ— å¼ºæ ¹ï¼Œå¤–å¼ºä¸­å¹²ï¼Œåˆ¤èº«å¼±ã€‚"; }
        } else if (!menWang && diWang) {
            if (dayRootStrong) { finalStrong = true; desc = "è™½å¤±æœˆä»¤ï¼Œä½†çœŸç¥ç›¸åŠ©ä¸”æ—¥åå¼ºæ ¹ï¼Œç»å¤„é€¢ç”Ÿï¼Œåˆ¤èº«å¼ºã€‚"; }
            else { finalStrong = false; desc = "è™½çœŸç¥å¾—ç”¨ï¼Œä½†å…¨å±€å…‹æ³„è¾ƒé‡ï¼Œåˆ¤èº«å¼±å–œç”Ÿæ‰¶ã€‚"; }
        } else {
            if (dayRootStrong && ["å† å¸¦","ä¸´å®˜"].includes(hourCs)) { finalStrong = true; desc = "è™½ç”Ÿäºè¡°æœˆï¼Œä½†æ—¥æ—¶ç¦„æ—ºé€šæ ¹ï¼Œåˆ¤èº«å¼ºã€‚"; }
            else { finalStrong = false; desc = "é—¨åœ°ä¿±è¡°ï¼Œæ ¹æ°”ä¸è¶³ï¼ŒçœŸèº«å¼±ã€‚"; }
        }

        return { isStrong: finalStrong, desc, dmWx };
    }

    function renderCoreQishu(status, cmdInfo, dm, mZ, pillars) {
        let joys = [];
        let taboos = [];
        
        const season = ["äº¥","å­","ä¸‘"].includes(mZ) ? "å†¬" : ["å·³","åˆ","æœª"].includes(mZ) ? "å¤" : "å¹³";
        
        if (status.isStrong) {
            joys.push("é£Ÿä¼¤ (æ³„ç§€)"); joys.push("å®˜æ€ (æŠ¤è´¢)"); joys.push("è´¢æ˜Ÿ (å…»å‘½)");
            taboos.push("å°æ˜Ÿ (è¿‡æ—º)"); taboos.push("æ¯”åŠ« (å¤ºè´¢)");
        } else {
            joys.push("å°æ˜Ÿ (è´µäºº)"); joys.push("æ¯”åŠ« (å¸®èº«)");
            taboos.push("å®˜æ€ (å‹åŠ›)"); taboos.push("é£Ÿä¼¤ (æ³„æ°”)");
        }

        if (season === "å†¬") { joys.unshift("ğŸ”¥ ç« (æš–å±€)"); taboos.push("ğŸ’§ æ°´ (æ¹¿å¯’)"); }
        if (season === "å¤") { joys.unshift("ğŸ’§ æ°´ (æ¶¦å±€)"); taboos.push("ğŸ”¥ ç« (ç„¦ç‡¥)"); }

        let html = `<div><strong>çœŸç¥å¸ä»¤ï¼š</strong>${cmdInfo.commander} (${SHISHEN_MAP[dm][cmdInfo.commander] || 'æ°”'})</div>`;
        html += `<div><strong>èƒ½é‡åˆ¤å®šï¼š</strong>${status.desc}</div>`;
        html += `<div style="margin-top:5px;"><strong>ä½œæˆ˜ç­–ç•¥ï¼š</strong>`;
        joys.forEach(j => html += `<span style="color:#2ed573;margin-right:5px;">[å–œ:${j}]</span>`);
        html += `</div>`;

        document.getElementById('core-analysis').innerHTML = html;
    }

    function drawArt(pillars, mZ) {
        const canvas = document.getElementById('energy-canvas');
        const ctx = canvas.getContext('2d');
        const w = canvas.parentElement.offsetWidth;
        const h = canvas.parentElement.offsetHeight;
        canvas.width = w; canvas.height = h;

        const counts = {'é‡‘':0,'æœ¨':0,'æ°´':0,'ç«':0,'åœŸ':0};
        pillars.forEach(p => { counts[WUXING_MAP[p.g]]++; counts[WUXING_MAP[p.z]]++; });
        
        // ç»˜åˆ¶èƒŒæ™¯ï¼ˆæ¨¡æ‹Ÿé›·è¾¾æ‰«æï¼‰
        ctx.fillStyle = "#111"; ctx.fillRect(0,0,w,h);
        
        // ç»˜åˆ¶äº”è¡Œèƒ½é‡æŸ±
        const colors = {"é‡‘":"#ffeaa7", "æœ¨":"#55efc4", "æ°´":"#74b9ff", "ç«":"#ff7675", "åœŸ":"#a29bfe"};
        let x = 20; const barW = (w - 40) / 5;
        for(let wx in counts) {
            const val = counts[wx];
            const barH = (val / 8) * h * 0.8;
            ctx.fillStyle = colors[wx];
            ctx.fillRect(x, h - barH, barW - 10, barH);
            
            ctx.font = "12px Arial"; ctx.fillStyle = "#fff";
            ctx.fillText(wx + " " + val, x + 5, h - barH - 5);
            x += barW;
        }
    }

    // === æ ¸å¿ƒï¼šæ¸¸æˆåŒ–æ ¼å±€åˆ¤å®š ===
    function renderGamePattern(pillars, dm, mz) {
        const godMap = {}; 
        const positions = ['å¹´å¹²', 'æœˆå¹²', 'æ—¥å¹²', 'æ—¶å¹²'];
        const gans = [pillars[0].g, pillars[1].g, pillars[2].g, pillars[3].g];
        
        gans.forEach((g, i) => { if(i === 2) return; godMap[positions[i]] = SHISHEN_MAP[dm][g]; });

        let key = "äº”è¡Œæµé€š";
        
        const hasSha = Object.values(godMap).includes("ä¸ƒæ€");
        if (hasSha) {
            const mGod = godMap['æœˆå¹²']; const yGod = godMap['å¹´å¹²']; const hGod = godMap['æ—¶å¹²'];
            let isControlled = false;
            if (mGod === "ä¸ƒæ€" && (yGod === "é£Ÿç¥" || hGod === "é£Ÿç¥")) isControlled = true;
            if (yGod === "ä¸ƒæ€" && mGod === "é£Ÿç¥") isControlled = true;
            if (hGod === "ä¸ƒæ€" && mGod === "é£Ÿç¥") isControlled = true;

            if (isControlled) key = "é£Ÿç¥åˆ¶æ€";
            else if (Object.values(godMap).includes("ä¼¤å®˜")) key = "ä¼¤å®˜åˆæ€";
            else key = "ä¼¤å®˜åˆæ€"; // é»˜è®¤å½’ç±»åˆ°æ€æ ¼å˜ç§ï¼Œç®€åŒ–å¤„ç†
        }
        else if (Object.values(godMap).includes("ä¼¤å®˜")) {
            const mGod = godMap['æœˆå¹²']; const yGod = godMap['å¹´å¹²']; const hGod = godMap['æ—¶å¹²'];
            let isShengCai = false;
            // ä¸¥è°¨åˆ¤å®šï¼šç›¸é‚»æ‰ç®—ç”Ÿè´¢
            if (mGod === "ä¼¤å®˜" && (["æ­£è´¢","åè´¢"].includes(yGod) || ["æ­£è´¢","åè´¢"].includes(hGod))) isShengCai = true;
            if (["æ­£è´¢","åè´¢"].includes(mGod) && (yGod === "ä¼¤å®˜" || hGod === "ä¼¤å®˜")) isShengCai = true;

            if (isShengCai) key = "ä¼¤å®˜ç”Ÿè´¢";
            else key = "ä¼¤å®˜åˆæ€"; // å€Ÿç”¨ä¼¤å®˜å¼ºåŠ›æ–‡æ¡ˆ
        }
        else if (["æ¯”è‚©","åŠ«è´¢"].includes(SHISHEN_MAP[dm][pillars[1].z])) key = "å»ºç¦„æ ¼";
        else if (Object.values(godMap).includes("æ­£å®˜")) key = "æ­£å®˜æ ¼";

        // å…œåº•
        if(!GAME_DB[key]) key = "å»ºç¦„æ ¼"; // é»˜è®¤å¼ºæ ¼

        const data = GAME_DB[key];
        const genderKey = currentGender === 1 ? 'male' : 'female';
        const detail = data[genderKey];

        // æ¸²æŸ“è§’è‰²å¤´éƒ¨
        document.getElementById('role-icon').innerText = data.icon;
        document.getElementById('role-name').innerText = data.name;
        document.getElementById('role-slogan').innerText = data.slogan;
        
        let tagsHtml = "";
        data.tags.forEach(t => tagsHtml += `<span class="tag ${t==='SSR'?'ssr':''}">${t}</span>`);
        document.getElementById('role-tags').innerHTML = tagsHtml;

        // æ¸²æŸ“æ”»ç•¥
        document.getElementById('txt-career').innerHTML = detail.c;
        document.getElementById('txt-wealth').innerHTML = detail.w;
        document.getElementById('txt-love').innerHTML = detail.l;
        document.getElementById('txt-kids').innerHTML = detail.k;
        document.getElementById('txt-health').innerHTML = detail.h;
    }

</script>
</body>
</html>
